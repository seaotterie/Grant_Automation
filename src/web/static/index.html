<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalynx - Grant Research Automation</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Alpine.js for reactivity -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/style.css">
    
    <!-- Configure Tailwind -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a'
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite'
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(10px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 font-sans antialiased transition-colors duration-300" x-data="catalynxApp()">
    
    <!-- Mobile Header -->
    <div class="lg:hidden bg-gray-900 dark:bg-gray-800 text-white px-4 py-3 flex items-center justify-between">
        <button @click="mobileMenuOpen = !mobileMenuOpen" class="text-gray-300 hover:text-white">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
        </button>
        <h1 class="text-lg font-semibold">Catalynx</h1>
        <button @click="darkMode = !darkMode" class="text-gray-300 hover:text-white">
            <svg x-show="!darkMode" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
            </svg>
            <svg x-show="darkMode" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
            </svg>
        </button>
    </div>

    <!-- Main Container -->
    <div class="min-h-screen flex">
        
        <!-- Mobile Menu Overlay -->
        <div x-show="mobileMenuOpen" x-transition class="fixed inset-0 z-50 lg:hidden">
            <div class="fixed inset-0 bg-black bg-opacity-50" @click="mobileMenuOpen = false"></div>
            <div class="fixed left-0 top-0 h-full w-80 bg-gray-900 dark:bg-gray-800 shadow-xl overflow-y-auto">
                <div class="p-4">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-xl font-bold text-white">Menu</h2>
                        <button @click="mobileMenuOpen = false" class="text-gray-300 hover:text-white">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <!-- Mobile navigation content will mirror desktop sidebar -->
                </div>
            </div>
        </div>
        
        <!-- Desktop Sidebar Navigation -->
        <div class="hidden lg:block bg-gray-900 dark:bg-gray-800 text-white w-80 min-h-screen flex-shrink-0 transition-colors duration-300">
            <!-- Logo Header -->
            <div class="p-4 border-b border-gray-800 dark:border-gray-700">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-xl font-bold flex items-center">
                            <span class="text-2xl mr-2">üéØ</span>
                            <span class="font-bold">Opportunistic Grantmogrifier</span>
                        </h1>
                        <p class="text-sm text-gray-400 mt-1">Grant Research Automation</p>
                    </div>
                    
                    <!-- Dark Mode Toggle -->
                    <button @click="toggleDarkMode()" 
                            class="p-2 rounded-lg hover:bg-gray-700 dark:hover:bg-gray-600 transition-colors"
                            :title="darkMode ? 'Switch to light mode' : 'Switch to dark mode'">
                        <span x-show="!darkMode" class="text-lg">üåô</span>
                        <span x-show="darkMode" class="text-lg">‚òÄÔ∏è</span>
                    </button>
                </div>
            </div>
            
            <!-- Enhanced Operational Navigation -->
            <nav class="mt-6">
                <!-- Pipeline Control -->
                <div class="px-2 mb-6">
                    <a href="#" @click.prevent="switchTab('pipeline')"
                       :class="{'bg-blue-600 text-white': activeTab === 'pipeline', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'pipeline'}"
                       class="flex items-center px-4 py-4 text-sm font-medium rounded-lg transition-colors border border-blue-500/30">
                        <span class="text-xl mr-3">üéØ</span>
                        <div class="flex-1">
                            <div class="font-semibold">Pipeline Control</div>
                            <div class="text-xs opacity-75">Live Processing</div>
                        </div>
                        <div x-show="activeWorkflows > 0" class="bg-orange-500 text-white text-xs rounded-full px-2 py-1 animate-pulse" x-text="activeWorkflows"></div>
                    </a>
                </div>

                <!-- P PARADOXIFIER -->
                <div class="px-2 mb-4" x-data="{ expanded: activeTab === 'status' || activeTab === 'profiles' }" x-init="$watch('activeTab', value => { if (value === 'status' || value === 'profiles') expanded = true })">
                    <h3 class="px-3 text-xs font-bold text-purple-400 uppercase tracking-wider mb-2 cursor-pointer" @click="expanded = !expanded">P PARADOXIFIER</h3>
                    <div x-show="expanded" x-transition class="space-y-0.5">
                        <a href="#" @click.prevent="switchTab('status')"
                           :class="{'bg-primary-600 text-white': activeTab === 'status', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'status'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors">
                            <div class="flex-1"><div class="font-bold">GLOBAL STATUS</div></div>
                        </a>
                        <a href="#" @click.prevent="switchTab('profiles')"
                           :class="{'bg-primary-600 text-white': activeTab === 'profiles', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'profiles'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors">
                            <div class="flex-1"><div class="font-bold">PROFILER</div></div>
                        </a>
                    </div>
                </div>

                <!-- D DISCOMBOBULATOR -->
                <div class="px-2 mb-4" x-data="{ expanded: ['discovery','prescoring','analysis','recommendations','commercial','states','predictive','roi'].includes(activeTab) }" x-init="$watch('activeTab', value => { if (['discovery','prescoring','analysis','recommendations','commercial','states','predictive','roi'].includes(value)) expanded = true })">
                    <h3 class="px-3 text-xs font-bold text-green-400 uppercase tracking-wider mb-2 cursor-pointer" @click="expanded = !expanded">D DISCOMBOBULATOR</h3>
                    
                    <!-- Phase 1.2: Processor Group Controls -->
                    <div class="px-3 mb-3 bg-gray-800 rounded-lg p-2 border border-gray-700">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <span class="text-xs font-semibold text-gray-400">Status:</span>
                                <span :class="getProcessorStatusClass(processorControls.discombobulator.status)" 
                                      class="text-xs font-bold" x-text="processorControls.discombobulator.status.toUpperCase()"></span>
                                <span x-text="getProcessorStatusIcon(processorControls.discombobulator.status)"></span>
                                <span x-show="processorControls.discombobulator.profileContext" 
                                      class="text-xs bg-blue-600 px-1 rounded text-white" 
                                      x-text="'Profile: ' + (processorControls.discombobulator.profileContext?.name || 'N/A')"></span>
                            </div>
                            <div class="flex space-x-1">
                                <button @click="startDiscombobulatorGroup()" 
                                        :disabled="processorControls.discombobulator.running"
                                        :class="{'opacity-50 cursor-not-allowed': processorControls.discombobulator.running}"
                                        class="px-2 py-1 text-xs bg-green-600 hover:bg-green-500 text-white rounded transition-colors">
                                    Start
                                </button>
                                <button @click="stopDiscombobulatorGroup()" 
                                        :disabled="!processorControls.discombobulator.canStop"
                                        :class="{'opacity-50 cursor-not-allowed': !processorControls.discombobulator.canStop}"
                                        class="px-2 py-1 text-xs bg-red-600 hover:bg-red-500 text-white rounded transition-colors">
                                    Stop
                                </button>
                            </div>
                        </div>
                        
                        <!-- Progress Bar -->
                        <div class="mb-2">
                            <div class="flex items-center justify-between text-xs text-gray-400 mb-1">
                                <span x-text="processorControls.discombobulator.currentTask || 'Ready'"></span>
                                <span x-text="Math.round(processorControls.discombobulator.progress) + '%'"></span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-1.5">
                                <div class="bg-green-400 h-1.5 rounded-full transition-all duration-300" 
                                     :style="`width: ${processorControls.discombobulator.progress}%`"></div>
                            </div>
                        </div>
                        
                        <!-- Individual Processor Status -->
                        <div class="grid grid-cols-2 gap-1 text-xs">
                            <div class="flex items-center space-x-1">
                                <span x-text="getProcessorStatusIcon(processorStatus.nonprofit_track.status)"></span>
                                <span class="text-gray-400">Nonprofit</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span x-text="getProcessorStatusIcon(processorStatus.federal_track.status)"></span>
                                <span class="text-gray-400">Federal</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span x-text="getProcessorStatusIcon(processorStatus.state_track.status)"></span>
                                <span class="text-gray-400">State</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span x-text="getProcessorStatusIcon(processorStatus.commercial_track.status)"></span>
                                <span class="text-gray-400">Commercial</span>
                            </div>
                        </div>
                    </div>
                    
                    <div x-show="expanded" x-transition class="space-y-0.5">
                    <div class="space-y-1">
                        <a href="#" @click.prevent="switchTab('discovery')"
                           :class="{'bg-primary-600 text-white': activeTab === 'discovery', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'discovery'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors group">
                            <div class="flex-1"><div class="font-bold">FULL SUMMARY</div></div>
                        </a>
                        <a href="#" @click.prevent="switchTab('prescoring')"
                           :class="{'bg-primary-600 text-white': activeTab === 'prescoring', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'prescoring'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors group">
                            <div class="flex-1"><div class="font-bold">NONPROFIT TRACK</div></div>
                        </a>
                        <a href="#" @click.prevent="switchTab('analysis')"
                           :class="{'bg-primary-600 text-white': activeTab === 'analysis', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'analysis'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors group">
                            <div class="flex-1"><div class="font-bold">FEDERAL TRACK</div></div>
                        </a>
                        <a href="#" @click.prevent="switchTab('recommendations')"
                           :class="{'bg-primary-600 text-white': activeTab === 'recommendations', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'recommendations'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors group">
                            <div class="flex-1"><div class="font-bold">STATE AGENCIES</div></div>
                        </a>
                        
                        <!-- Commercial Track -->
                        <a href="#" @click.prevent="switchTab('commercial')"
                           :class="{'bg-primary-600 text-white': activeTab === 'commercial', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'commercial'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors">
                            <div class="flex-1"><div class="font-bold">COMMERCIAL TRACK</div></div>
                        </a>
                        
                        <!-- State Discovery -->
                        <a href="#" @click.prevent="switchTab('states')"
                           :class="{'bg-primary-600 text-white': activeTab === 'states', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'states'}"
                           class="flex items-center px-4 py-3 text-sm font-medium rounded-md transition-colors">
                            <span class="text-lg mr-3">üèõÔ∏è</span>
                            <div class="flex-1"><div>BOARD OF DIRECTORS</div><div class="text-xs opacity-75">State Agencies</div></div>
                        </a>
                        
                        <!-- Predictive Analytics -->
                        <a href="#" @click.prevent="switchTab('predictive')"
                           :class="{'bg-primary-600 text-white': activeTab === 'predictive', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'predictive'}"
                           class="flex items-center px-4 py-3 text-sm font-medium rounded-md transition-colors">
                            <span class="text-lg mr-3">üîÆ</span>
                            <div class="flex-1"><div>GRANTEE NETWORK</div><div class="text-xs opacity-75">Success Models</div></div>
                        </a>
                        
                        <!-- ROI Analytics -->
                        <a href="#" @click.prevent="switchTab('roi')"
                           :class="{'bg-primary-600 text-white': activeTab === 'roi', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'roi'}"
                           class="flex items-center px-4 py-3 text-sm font-medium rounded-md transition-colors">
                            <span class="text-lg mr-3">üìä</span>
                            <div class="flex-1"><div>SCROGIN SUMMARY</div><div class="text-xs opacity-75">Optimization</div></div>
                        </a>
                    </div>
                </div>

                <!-- A AMPLINATOR -->
                <div class="px-2 mb-4" x-data="{ expanded: ['analytics','network','exports','classification','workflows'].includes(activeTab) }" x-init="$watch('activeTab', value => { if (['analytics','network','exports','classification','workflows'].includes(value)) expanded = true })">
                    <h3 class="px-3 text-xs font-bold text-purple-400 uppercase tracking-wider mb-2 cursor-pointer" @click="expanded = !expanded">A AMPLINATOR</h3>
                    
                    <!-- Phase 1.2: Processor Group Controls -->
                    <div class="px-3 mb-3 bg-gray-800 rounded-lg p-2 border border-gray-700">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <span class="text-xs font-semibold text-gray-400">Status:</span>
                                <span :class="getProcessorStatusClass(processorControls.amplinator.status)" 
                                      class="text-xs font-bold" x-text="processorControls.amplinator.status.toUpperCase()"></span>
                                <span x-text="getProcessorStatusIcon(processorControls.amplinator.status)"></span>
                                <span x-show="processorControls.amplinator.profileContext" 
                                      class="text-xs bg-blue-600 px-1 rounded text-white" 
                                      x-text="'Profile: ' + (processorControls.amplinator.profileContext?.name || 'N/A')"></span>
                            </div>
                            <div class="flex space-x-1">
                                <button @click="startAmplinatorGroup()" 
                                        :disabled="processorControls.amplinator.running"
                                        :class="{'opacity-50 cursor-not-allowed': processorControls.amplinator.running}"
                                        class="px-2 py-1 text-xs bg-purple-600 hover:bg-purple-500 text-white rounded transition-colors">
                                    Start
                                </button>
                                <button @click="stopAmplinatorGroup()" 
                                        :disabled="!processorControls.amplinator.canStop"
                                        :class="{'opacity-50 cursor-not-allowed': !processorControls.amplinator.canStop}"
                                        class="px-2 py-1 text-xs bg-red-600 hover:bg-red-500 text-white rounded transition-colors">
                                    Stop
                                </button>
                            </div>
                        </div>
                        
                        <!-- Progress Bar -->
                        <div class="mb-2">
                            <div class="flex items-center justify-between text-xs text-gray-400 mb-1">
                                <span x-text="processorControls.amplinator.currentTask || 'Ready'"></span>
                                <span x-text="Math.round(processorControls.amplinator.progress) + '%'"></span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-1.5">
                                <div class="bg-purple-400 h-1.5 rounded-full transition-all duration-300" 
                                     :style="`width: ${processorControls.amplinator.progress}%`"></div>
                            </div>
                        </div>
                        
                        <!-- Individual Processor Status -->
                        <div class="grid grid-cols-2 gap-1 text-xs">
                            <div class="flex items-center space-x-1">
                                <span x-text="getProcessorStatusIcon(processorStatus.scoring_analysis.status)"></span>
                                <span class="text-gray-400">Scoring</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span x-text="getProcessorStatusIcon(processorStatus.network_analysis.status)"></span>
                                <span class="text-gray-400">Network</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span x-text="getProcessorStatusIcon(processorStatus.export_functions.status)"></span>
                                <span class="text-gray-400">Export</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span x-text="getProcessorStatusIcon(processorStatus.report_generation.status)"></span>
                                <span class="text-gray-400">Reports</span>
                            </div>
                        </div>
                    </div>
                    
                    <div x-show="expanded" x-transition class="space-y-0.5">
                    <div class="space-y-1">
                        <a href="#" @click.prevent="switchTab('analytics')"
                           :class="{'bg-primary-600 text-white': activeTab === 'analytics', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'analytics'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors">
                            <div class="flex-1"><div class="font-bold">SCORING SUMMARY</div></div>
                        </a>
                        <a href="#" @click.prevent="switchTab('network')"
                           :class="{'bg-primary-600 text-white': activeTab === 'network', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'network'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors">
                            <div class="flex-1"><div class="font-bold">EXPORT FUNCTIONS</div></div>
                        </a>
                        <a href="#" @click.prevent="switchTab('exports')"
                           :class="{'bg-primary-600 text-white': activeTab === 'exports', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'exports'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors">
                            <div class="flex-1"><div class="font-bold">REPORT GENERATION</div></div>
                        </a>
                        
                        <!-- Legacy Tools Collapsible -->
                        <div class="px-4 py-2">
                            <details class="group">
                                <summary class="flex items-center cursor-pointer text-gray-400 hover:text-gray-300 text-sm">
                                    <span class="text-base mr-2">‚ö°</span>Legacy Tools
                                </summary>
                                <div class="mt-2 ml-6 space-y-1">
                                    <a href="#" @click.prevent="switchTab('classification')" class="flex items-center px-3 py-2 text-sm text-gray-300 hover:text-white rounded-md transition-colors">
                                        <span class="mr-2">üß†</span>Classification
                                    </a>
                                    <a href="#" @click.prevent="switchTab('workflows')" class="flex items-center px-3 py-2 text-sm text-gray-300 hover:text-white rounded-md transition-colors">
                                        <span class="mr-2">üîÑ</span>Workflows
                                    </a>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>
                
                <!-- T TESTINATOR -->
                <div class="px-2 mb-4" x-data="{ expanded: activeTab === 'testing' }" x-init="$watch('activeTab', value => { if (value === 'testing') expanded = true })">
                    <h3 class="px-3 text-xs font-bold text-orange-400 uppercase tracking-wider mb-2 cursor-pointer" @click="expanded = !expanded">T TESTINATOR</h3>
                    <div x-show="expanded" x-transition class="space-y-0.5">
                        <a href="#" 
                           @click.prevent="switchTab('testing')"
                           :class="{'bg-primary-600 text-white': activeTab === 'testing', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'testing'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors">
                            <span class="text-lg mr-3">üß™</span>
                            <div class="flex-1"><div class="font-bold">TESTING INTERFACE</div><div class="text-xs opacity-75">Processor Testing & Monitoring</div></div>
                        </a>
                    </div>
                </div>

                <!-- C CONFIGURAMA -->
                <div class="mt-6 px-2" x-data="{ expanded: activeTab === 'settings' }" x-init="$watch('activeTab', value => { if (value === 'settings') expanded = true })">
                    <h3 class="px-3 text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 cursor-pointer" @click="expanded = !expanded">C CONFIGURAMA</h3>
                    <div x-show="expanded" x-transition class="space-y-0.5">
                        <a href="#" 
                           @click.prevent="switchTab('settings')"
                           :class="{'bg-primary-600 text-white': activeTab === 'settings', 'text-gray-300 hover:bg-gray-700 hover:text-white': activeTab !== 'settings'}"
                           class="flex items-center px-4 py-2 text-sm font-bold rounded-md transition-colors">
                            <div class="flex-1"><div class="font-bold">SETTINGS</div></div>
                        </a>
                    </div>
                </div>
                
                <!-- Recent Activity -->
                <div class="mt-8 px-2">
                    <h3 class="px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider">Recent</h3>
                    <div class="mt-2 space-y-1" x-show="recentActivity.length > 0">
                        <template x-for="activity in recentActivity.slice(0, 3)" :key="activity.id">
                            <div class="px-4 py-2 text-sm text-gray-300">
                                <div class="font-medium" x-text="activity.name"></div>
                                <div class="text-gray-400 text-xs" x-text="activity.time"></div>
                            </div>
                        </template>
                    </div>
                    <div x-show="recentActivity.length === 0" class="px-4 py-2 text-sm text-gray-400">
                        No recent activity
                    </div>
                </div>
            </nav>
        </div>
        
        <!-- Main Content Area -->
        <div class="flex-1 flex flex-col min-h-screen lg:min-h-0">
            
            <!-- Top Bar -->
            <header class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 lg:px-6 py-3 lg:py-4 transition-colors duration-300">
                <div class="flex items-center justify-between">
                    <div>
                        <h2 class="text-2xl font-semibold text-gray-900 dark:text-white" x-text="getPageTitle()"></h2>
                        <p class="text-sm text-gray-600 dark:text-gray-300 mt-1" x-text="getPageDescription()"></p>
                    </div>
                    
                    <!-- Global Search Bar -->
                    <div class="flex-1 max-w-lg mx-8">
                        <div class="relative">
                            <input type="text" 
                                   x-model="globalSearchQuery"
                                   @keyup.enter="performGlobalSearch()"
                                   placeholder="Search profiles, organizations, workflows..."
                                   class="w-full bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2 pl-10 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <svg class="h-4 w-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                            </div>
                            <button @click="openAdvancedFilters()" 
                                    class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Enhanced System Status Indicators -->
                    <div class="flex items-center space-x-6">
                        <!-- Overall System Health -->
                        <div class="flex items-center">
                            <div :class="systemStatus === 'healthy' ? 'bg-green-400 animate-pulse' : systemStatus === 'warning' ? 'bg-yellow-400 animate-pulse' : 'bg-red-400 animate-pulse'" 
                                 class="w-3 h-3 rounded-full mr-2"></div>
                            <div class="text-sm">
                                <div class="text-gray-900 dark:text-white font-medium" x-text="getSystemStatusText()"></div>
                                <div class="text-gray-500 dark:text-gray-400 text-xs" x-text="systemInfo.uptime || 'Unknown uptime'"></div>
                            </div>
                        </div>
                        
                        <!-- API Status -->
                        <div class="flex items-center">
                            <div :class="apiStatus === 'healthy' ? 'bg-green-400' : apiStatus === 'slow' ? 'bg-yellow-400' : 'bg-red-400'" 
                                 class="w-2 h-2 rounded-full mr-2"></div>
                            <div class="text-sm">
                                <div class="text-gray-600 dark:text-gray-300">API</div>
                                <div class="text-gray-500 dark:text-gray-400 text-xs" x-text="getApiStatusText()"></div>
                            </div>
                        </div>
                        
                        <!-- Processing Queue -->
                        <div class="flex items-center" x-show="activeWorkflows > 0">
                            <div class="w-2 h-2 bg-blue-400 rounded-full mr-2 animate-pulse"></div>
                            <div class="text-sm">
                                <div class="text-gray-600 dark:text-gray-300">Processing</div>
                                <div class="text-gray-500 dark:text-gray-400 text-xs" x-text="`${activeWorkflows} active`"></div>
                            </div>
                        </div>
                        
                        <!-- Team Collaboration -->
                        <div class="flex items-center space-x-2 border-l border-gray-300 dark:border-gray-600 pl-4">
                            <!-- Online Users -->
                            <div class="flex -space-x-1">
                                <template x-for="user in getOnlineUsers().slice(0, 3)" :key="user.id">
                                    <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white text-xs font-medium border-2 border-white dark:border-gray-800" 
                                         :title="user.name" x-text="user.avatar"></div>
                                </template>
                                <div x-show="getOnlineUsers().length > 3" 
                                     class="w-8 h-8 rounded-full bg-gray-400 flex items-center justify-center text-white text-xs font-medium border-2 border-white dark:border-gray-800"
                                     x-text="`+${getOnlineUsers().length - 3}`"></div>
                            </div>
                            
                            <!-- Notifications -->
                            <div class="relative">
                                <button @click="collaborationModalOpen = true" class="p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 relative">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5-5-5h5V7H9v10z"></path>
                                    </svg>
                                    <span x-show="getUnreadNotifications().length > 0" 
                                          class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center"
                                          x-text="getUnreadNotifications().length"></span>
                                </button>
                            </div>
                        </div>

                        <!-- Live Clock -->
                        <div class="text-sm text-gray-500 dark:text-gray-400 border-l border-gray-300 dark:border-gray-600 pl-4">
                            <div x-text="currentTime"></div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Main Content -->
            <main class="flex-1 p-4 lg:p-6 bg-gray-50 dark:bg-gray-900 transition-colors duration-300 overflow-auto">
                
                <!-- Pipeline Control Tab -->
                <div x-show="activeTab === 'pipeline'" class="space-y-6">
                    <!-- Pipeline Overview Header -->
                    <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-2xl font-bold">Pipeline Control Center</h3>
                                <p class="mt-2 opacity-90">Real-time processing monitoring and control</p>
                            </div>
                            <div class="text-right">
                                <div class="text-3xl font-bold" x-text="activeWorkflows || '0'"></div>
                                <div class="text-sm opacity-90">Active Workflows</div>
                            </div>
                        </div>
                    </div>

                    <!-- Pipeline Stage Status Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border-l-4 border-blue-500">
                            <div class="flex items-center justify-between">
                                <div><p class="text-sm font-medium text-gray-600 dark:text-gray-400">Stage 1: Discovery</p><p class="text-2xl font-bold text-gray-900 dark:text-white">12</p></div>
                                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-bold">1</div>
                            </div>
                            <div class="mt-2 flex items-center">
                                <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2"><div class="bg-blue-500 h-2 rounded-full" style="width: 75%"></div></div>
                                <span class="ml-2 text-sm text-gray-600 dark:text-gray-400">75%</span>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border-l-4 border-yellow-500">
                            <div class="flex items-center justify-between">
                                <div><p class="text-sm font-medium text-gray-600 dark:text-gray-400">Stage 2: Pre-Scoring</p><p class="text-2xl font-bold text-gray-900 dark:text-white">8</p></div>
                                <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center text-white text-sm font-bold">2</div>
                            </div>
                            <div class="mt-2 flex items-center">
                                <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2"><div class="bg-yellow-500 h-2 rounded-full" style="width: 45%"></div></div>
                                <span class="ml-2 text-sm text-gray-600 dark:text-gray-400">45%</span>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border-l-4 border-purple-500">
                            <div class="flex items-center justify-between">
                                <div><p class="text-sm font-medium text-gray-600 dark:text-gray-400">Stage 3: Analysis</p><p class="text-2xl font-bold text-gray-900 dark:text-white">5</p></div>
                                <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm font-bold">3</div>
                            </div>
                            <div class="mt-2 flex items-center">
                                <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2"><div class="bg-purple-500 h-2 rounded-full" style="width: 25%"></div></div>
                                <span class="ml-2 text-sm text-gray-600 dark:text-gray-400">25%</span>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border-l-4 border-green-500">
                            <div class="flex items-center justify-between">
                                <div><p class="text-sm font-medium text-gray-600 dark:text-gray-400">Stage 4: Recommendations</p><p class="text-2xl font-bold text-gray-900 dark:text-white">15</p></div>
                                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-bold">4</div>
                            </div>
                            <div class="mt-2 flex items-center">
                                <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2"><div class="bg-green-500 h-2 rounded-full" style="width: 90%"></div></div>
                                <span class="ml-2 text-sm text-gray-600 dark:text-gray-400">90%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Live Processing Activity -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                        <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Live Processing Activity</h4>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-blue-500 rounded-full animate-pulse mr-3"></div>
                                    <div><p class="font-medium">Profile: Tech Nonprofit Foundation</p><p class="text-sm text-gray-600 dark:text-gray-400">Discovery stage - Processing 247 opportunities</p></div>
                                </div>
                                <span class="text-sm font-medium text-blue-600 dark:text-blue-400">Stage 1</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg">
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-yellow-500 rounded-full animate-pulse mr-3"></div>
                                    <div><p class="font-medium">Profile: Healthcare Initiative</p><p class="text-sm text-gray-600 dark:text-gray-400">Pre-scoring 189 candidates</p></div>
                                </div>
                                <span class="text-sm font-medium text-yellow-600 dark:text-yellow-400">Stage 2</span>
                            </div>
                        </div>
                    </div>

                    <!-- Resource Allocation & Controls -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Resource Allocation</h4>
                            <div class="space-y-4">
                                <div><div class="flex justify-between text-sm mb-1"><span>CPU Usage</span><span>68%</span></div><div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"><div class="bg-blue-500 h-2 rounded-full" style="width: 68%"></div></div></div>
                                <div><div class="flex justify-between text-sm mb-1"><span>API Rate Limit</span><span>23%</span></div><div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"><div class="bg-green-500 h-2 rounded-full" style="width: 23%"></div></div></div>
                                <div><div class="flex justify-between text-sm mb-1"><span>Queue Depth</span><span>45%</span></div><div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"><div class="bg-yellow-500 h-2 rounded-full" style="width: 45%"></div></div></div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Pipeline Controls</h4>
                            <div class="space-y-3">
                                <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors">Start New Pipeline</button>
                                <button class="w-full bg-yellow-600 hover:bg-yellow-700 text-white font-medium py-2 px-4 rounded-md transition-colors">Pause All Processing</button>
                                <button class="w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-md transition-colors">Emergency Stop</button>
                                <button class="w-full bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-md transition-colors">View Detailed Logs</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Global Status Tab -->
                <div x-show="activeTab === 'status'" class="space-y-6">
                    <!-- Logo and System Overview -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center">
                        <div class="flex flex-col items-center space-y-6">
                            <!-- Catalynx Logo -->
                            <div class="w-32 h-32 mx-auto mb-6 flex items-center justify-center">
                                <img src="/static/CatalynxLogo.png" 
                                     alt="Catalynx Logo" 
                                     class="w-32 h-32 object-contain"
                                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <div class="w-32 h-32 bg-gradient-to-br from-purple-600 to-blue-600 rounded-full flex items-center justify-center shadow-xl" style="display:none;">
                                    <span class="text-6xl font-black text-white">CX</span>
                                </div>
                            </div>
                            
                            <!-- System Title -->
                            <div>
                                <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">
                                    Catalynx Intelligence Platform
                                </h1>
                                <p class="text-lg text-gray-600 dark:text-gray-400">
                                    Comprehensive Opportunity Intelligence & Network Analysis
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- System Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Active Workflows</p>
                                    <p class="text-3xl font-semibold text-gray-900 dark:text-white" x-text="stats.activeWorkflows"></p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center">
                                    <span class="text-2xl">‚ö°</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Organizations</p>
                                    <p class="text-3xl font-semibold text-gray-900 dark:text-white" x-text="totalProfiles || 0"></p>
                                </div>
                                <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center">
                                    <span class="text-2xl">üë§</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Success Rate</p>
                                    <p class="text-3xl font-semibold text-gray-900 dark:text-white" x-text="(stats.successRate * 100).toFixed(1) + '%'"></p>
                                </div>
                                <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center">
                                    <span class="text-2xl">üìä</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">System Status</p>
                                    <p class="text-lg font-semibold" :class="systemStatus === 'healthy' ? 'text-green-600' : 'text-red-600'" x-text="systemStatus === 'healthy' ? 'Operational' : 'Issues'"></p>
                                </div>
                                <div class="w-12 h-12 rounded-lg flex items-center justify-center" :class="systemStatus === 'healthy' ? 'bg-green-100 dark:bg-green-900' : 'bg-red-100 dark:bg-red-900'">
                                    <span class="text-2xl" x-text="systemStatus === 'healthy' ? '‚úÖ' : '‚ùå'"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Enhanced Performance Metrics Dashboard -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        
                        <!-- Real-time Performance Metrics -->
                        <div class="status-card">
                            <div class="status-card-header">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Performance Metrics</h3>
                                <div class="live-indicator">
                                    <div class="live-dot"></div>
                                    <span class="text-sm text-gray-600 dark:text-gray-400">Live</span>
                                </div>
                            </div>
                            <div class="status-card-body">
                                <div class="metrics-grid">
                                    <div class="metric-card">
                                        <span class="metric-value" x-text="formatDuration(performanceMetrics.averageProcessingTime)">0ms</span>
                                        <span class="metric-label">Avg Processing Time</span>
                                        <span class="metric-change" 
                                              :class="getPerformanceClass('responseTime', performanceMetrics.averageProcessingTime)"
                                              x-text="`${performanceMetrics.averageProcessingTime > 1000 ? '‚Üë' : '‚Üì'} ${performanceMetrics.averageProcessingTime > 1000 ? 'Slow' : 'Fast'}`">
                                        </span>
                                    </div>
                                    <div class="metric-card">
                                        <span class="metric-value" x-text="performanceMetrics.throughputPerSecond.toFixed(2)">0.00</span>
                                        <span class="metric-label">Ops/Second</span>
                                        <span class="metric-change" 
                                              :class="getPerformanceClass('throughput', performanceMetrics.throughputPerSecond)"
                                              x-text="`${performanceMetrics.throughputPerSecond > 1 ? '‚Üë' : '‚Üì'} ${performanceMetrics.throughputPerSecond > 1 ? 'High' : 'Low'}`">
                                        </span>
                                    </div>
                                    <div class="metric-card">
                                        <span class="metric-value" x-text="performanceMetrics.successRate.toFixed(1) + '%'">100%</span>
                                        <span class="metric-label">Success Rate</span>
                                        <span class="metric-change" 
                                              :class="getPerformanceClass('successRate', performanceMetrics.successRate)"
                                              x-text="`${performanceMetrics.successRate >= 90 ? '‚Üë' : '‚Üì'} ${performanceMetrics.successRate >= 90 ? 'Excellent' : 'Needs Attention'}`">
                                        </span>
                                    </div>
                                    <div class="metric-card">
                                        <span class="metric-value" x-text="realTimeStatus.latency.toFixed(0) + 'ms'">0ms</span>
                                        <span class="metric-label">Latency</span>
                                        <span class="metric-change" 
                                              :class="getPerformanceClass('latency', realTimeStatus.latency)"
                                              x-text="`${realTimeStatus.latency <= 100 ? '‚Üì' : '‚Üë'} ${realTimeStatus.latency <= 100 ? 'Low' : 'High'}`">
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="status-card-footer">
                                <div class="timing-display">
                                    <div class="timing-metric">
                                        <span class="timing-value" x-text="performanceMetrics.currentOperations">0</span>
                                        <span class="timing-label">Active</span>
                                    </div>
                                    <div class="timing-metric">
                                        <span class="timing-value" x-text="performanceMetrics.completedOperations">0</span>
                                        <span class="timing-label">Completed</span>
                                    </div>
                                    <div class="timing-metric">
                                        <span class="timing-value" x-text="performanceMetrics.errorCount">0</span>
                                        <span class="timing-label">Errors</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- System Status Dashboard -->
                        <div class="status-card">
                            <div class="status-card-header">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">System Status</h3>
                                <div class="status-indicator status-healthy">
                                    <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                                    <span x-text="systemStatus === 'healthy' ? 'Healthy' : 'Degraded'">Healthy</span>
                                </div>
                            </div>
                            <div class="status-card-body space-y-4">
                                <!-- Connection Status -->
                                <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-2 h-2 rounded-full" 
                                             :class="realTimeStatus.connectionStatus === 'connected' ? 'bg-green-500' : 'bg-red-500'"></div>
                                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">WebSocket Connection</span>
                                    </div>
                                    <span class="text-sm" 
                                          :class="realTimeStatus.connectionStatus === 'connected' ? 'text-green-600' : 'text-red-600'"
                                          x-text="realTimeStatus.connectionStatus">Disconnected</span>
                                </div>
                                
                                <!-- API Status -->
                                <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">API Services</span>
                                    </div>
                                    <span class="text-sm text-green-600" x-text="apiStatus">Healthy</span>
                                </div>
                                
                                <!-- Processors Status -->
                                <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Processors Available</span>
                                    </div>
                                    <span class="text-sm text-blue-600" x-text="stats.processorsAvailable || '18'">18</span>
                                </div>
                                
                                <!-- Messages Processed -->
                                <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Messages Processed</span>
                                    </div>
                                    <span class="text-sm text-purple-600" x-text="realTimeStatus.messageCount">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Process Flow Visualization -->
                    <div x-show="processFlow.steps.length > 0" class="status-card">
                        <div class="status-card-header">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Process Flow</h3>
                            <div class="flex items-center space-x-4">
                                <span class="text-sm text-gray-600 dark:text-gray-400" 
                                      x-text="`Step ${processFlow.currentStep + 1} of ${processFlow.totalSteps}`">Step 1 of 5</span>
                                <span class="text-sm text-gray-600 dark:text-gray-400" 
                                      x-text="`${getProcessFlowProgress().toFixed(0)}% Complete`">0% Complete</span>
                            </div>
                        </div>
                        <div class="status-card-body">
                            <!-- Progress Bar -->
                            <div class="progress-container mb-6">
                                <div class="progress-bar progress-striped" 
                                     :style="`width: ${getProcessFlowProgress()}%`"></div>
                            </div>
                            
                            <!-- Process Steps -->
                            <div class="process-flow">
                                <template x-for="(step, index) in processFlow.steps" :key="index">
                                    <div class="flex items-center">
                                        <div class="process-step">
                                            <div class="process-step-icon" 
                                                 :class="{
                                                     'process-step-pending': step.status === 'pending',
                                                     'process-step-active': step.status === 'active',
                                                     'process-step-completed': step.status === 'completed',
                                                     'process-step-error': step.status === 'error'
                                                 }"
                                                 x-text="index + 1">1</div>
                                            <div class="process-step-label" x-text="step.label">Step</div>
                                            <div x-show="step.message" class="text-xs text-gray-500 mt-1" x-text="step.message"></div>
                                        </div>
                                        <div x-show="index < processFlow.steps.length - 1" 
                                             class="process-connector"
                                             :class="{'process-connector-active': step.status === 'completed'}"></div>
                                    </div>
                                </template>
                            </div>
                            
                            <!-- Time Estimates -->
                            <div x-show="processFlow.estimatedTimeRemaining > 0" class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-blue-700 dark:text-blue-300">Estimated Time Remaining:</span>
                                    <span class="text-sm font-medium text-blue-800 dark:text-blue-200" 
                                          x-text="formatDuration(processFlow.estimatedTimeRemaining)">0ms</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Enhanced Error/Success Messages Demo -->
                    <div class="space-y-4">
                        <!-- Success Message Example -->
                        <div class="success-message">
                            <div class="success-header">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                </svg>
                                <span>System Operational</span>
                            </div>
                            <div class="text-sm text-green-700 dark:text-green-300">
                                All processors are running normally. Last successful operation completed in 2.3 seconds.
                            </div>
                        </div>
                        
                        <!-- Info Message Example -->
                        <div x-show="realTimeStatus.messageCount > 0" class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 border-l-4 border-l-blue-500 rounded-lg p-4">
                            <div class="flex items-center">
                                <svg class="w-5 h-5 text-blue-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                                </svg>
                                <span class="text-sm font-medium text-blue-800 dark:text-blue-200">
                                    Real-time monitoring active - <span x-text="realTimeStatus.messageCount">0</span> messages processed
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Dashboard Tab -->
                <div x-show="activeTab === 'dashboard'" class="space-y-6">
                    
                    <!-- Stats Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 transition-all duration-300 hover:shadow-xl hover:scale-105 animate-fade-in">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Active Workflows</p>
                                    <p class="text-3xl font-semibold text-gray-900 dark:text-white" x-text="stats.activeWorkflows"></p>
                                </div>
                                <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/50 rounded-full flex items-center justify-center text-blue-600 dark:text-blue-400">
                                    üîÑ
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 transition-all duration-300 hover:shadow-xl hover:scale-105 animate-fade-in">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Organizations Processed</p>
                                    <p class="text-3xl font-semibold text-gray-900 dark:text-white" x-text="stats.totalProcessed.toLocaleString()"></p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 dark:bg-green-900/50 rounded-full flex items-center justify-center text-green-600 dark:text-green-400">
                                    üìä
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 transition-all duration-300 hover:shadow-xl hover:scale-105 animate-fade-in">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Success Rate</p>
                                    <p class="text-3xl font-semibold text-gray-900 dark:text-white"><span x-text="(stats.successRate * 100).toFixed(1)"></span>%</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 dark:bg-green-900/50 rounded-full flex items-center justify-center text-green-600 dark:text-green-400">
                                    ‚úÖ
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 transition-all duration-300 hover:shadow-xl hover:scale-105 animate-fade-in">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Available Processors</p>
                                    <p class="text-3xl font-semibold text-gray-900 dark:text-white" x-text="stats.processorsAvailable"></p>
                                </div>
                                <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900/50 rounded-full flex items-center justify-center text-purple-600 dark:text-purple-400">
                                    ‚öôÔ∏è
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Live Progress Monitor -->
                    <div x-show="liveProgress.workflow_id" class="bg-white rounded-lg shadow">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-900">üî¥ LIVE: <span x-text="liveProgress.current_processor || 'Processing'"></span></h3>
                                <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">Active</span>
                            </div>
                        </div>
                        
                        <div class="p-6">
                            <div class="space-y-4">
                                <!-- Current Organization -->
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600">Current Organization:</span>
                                    <span class="font-medium" x-text="liveProgress.current_organization || 'Loading...'"></span>
                                </div>
                                
                                <!-- Progress Bar -->
                                <div>
                                    <div class="flex justify-between text-sm mb-2">
                                        <span class="text-gray-600">Progress</span>
                                        <span class="font-medium">
                                            <span x-text="liveProgress.processed_count || 0"></span> / 
                                            <span x-text="liveProgress.total_count || 0"></span>
                                            (<span x-text="Math.round(liveProgress.progress_percentage || 0)"></span>%)
                                        </span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-3">
                                        <div class="bg-blue-600 h-3 rounded-full transition-all duration-300" 
                                             :style="`width: ${liveProgress.progress_percentage || 0}%`"></div>
                                    </div>
                                </div>
                                
                                <!-- Performance Metrics -->
                                <div class="grid grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <span class="text-gray-600">Speed: </span>
                                        <span class="font-semibold" x-text="(liveProgress.processing_speed || 0).toFixed(1)"></span> orgs/sec
                                    </div>
                                    <div>
                                        <span class="text-gray-600">ETA: </span>
                                        <span class="font-semibold" x-text="liveProgress.eta_minutes ? Math.round(liveProgress.eta_minutes) + ' min' : 'Calculating...'"></span>
                                    </div>
                                </div>
                                
                                <!-- Qualification Breakdown -->
                                <div x-show="liveProgress.qualification_breakdown">
                                    <h4 class="text-sm font-medium text-gray-900 mb-2">Live Qualification Breakdown:</h4>
                                    <div class="space-y-1">
                                        <template x-for="[factor, count] in Object.entries(liveProgress.qualification_breakdown || {})" :key="factor">
                                            <div class="flex justify-between text-sm">
                                                <span x-text="factor"></span>
                                                <span class="font-medium">
                                                    <span x-text="count"></span> 
                                                    (<span x-text="liveProgress.processed_count > 0 ? ((count / liveProgress.processed_count) * 100).toFixed(1) : 0"></span>%)
                                                </span>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Workflows -->
                    <div class="bg-white rounded-lg shadow">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-900">Recent Activity</h3>
                        </div>
                        <div class="p-6">
                            <div x-show="recentActivity.length === 0" class="text-center text-gray-500 py-8">
                                No recent activity
                            </div>
                            <div x-show="recentActivity.length > 0" class="space-y-4">
                                <template x-for="activity in recentActivity" :key="activity.id">
                                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <div class="flex items-center">
                                            <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                                <span x-text="activity.type === 'classification' ? 'üß†' : 'üîÑ'"></span>
                                            </div>
                                            <div>
                                                <h4 class="font-medium text-gray-900" x-text="activity.name"></h4>
                                                <p class="text-sm text-gray-600" x-text="activity.description"></p>
                                            </div>
                                        </div>
                                        <div class="text-sm text-gray-500" x-text="activity.time"></div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Classification Tab -->
                <div x-show="activeTab === 'classification'" class="space-y-6">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 transition-all duration-300 animate-fade-in">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-6">üß† Intelligent Classification</h3>
                        
                        <!-- Classification Form -->
                        <form @submit.prevent="startClassification()" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">State</label>
                                    <select x-model="classificationParams.state" class="w-full rounded-md border-gray-300 shadow-sm">
                                        <option value="VA">Virginia</option>
                                        <option value="MD">Maryland</option>
                                        <option value="DC">District of Columbia</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Minimum Score</label>
                                    <input type="number" x-model="classificationParams.minScore" min="0" max="1" step="0.1" 
                                           class="w-full rounded-md border-gray-300 shadow-sm">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Maximum Results</label>
                                    <input type="number" x-model="classificationParams.maxResults" min="1" max="10000" 
                                           class="w-full rounded-md border-gray-300 shadow-sm">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Export Format</label>
                                    <select x-model="classificationParams.exportFormat" class="w-full rounded-md border-gray-300 shadow-sm">
                                        <option value="csv">CSV</option>
                                        <option value="json">JSON</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="flex items-center">
                                <input type="checkbox" x-model="classificationParams.detailedAnalysis" id="detailed" 
                                       class="rounded border-gray-300 mr-2">
                                <label for="detailed" class="text-sm text-gray-700">Include detailed qualification analysis</label>
                            </div>
                            
                            <div class="pt-4">
                                <button type="submit" 
                                        :disabled="isRunningClassification"
                                        :class="isRunningClassification ? 'bg-gray-400 cursor-not-allowed' : 'bg-primary-600 hover:bg-primary-700 hover:scale-105'"
                                        class="px-6 py-3 text-white rounded-md font-medium transition-all duration-200 transform">
                                    <span x-show="!isRunningClassification" class="flex items-center">
                                        <span class="mr-2">üöÄ</span> Start Classification
                                    </span>
                                    <span x-show="isRunningClassification" class="flex items-center">
                                        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                        Processing...
                                    </span>
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Loading Skeleton for Classification Results -->
                    <div x-show="isRunningClassification && classificationResults.length === 0" class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                        <div class="animate-pulse">
                            <div class="flex items-center justify-between mb-4">
                                <div class="h-6 bg-gray-300 dark:bg-gray-600 rounded w-48"></div>
                                <div class="h-4 bg-gray-300 dark:bg-gray-600 rounded w-24"></div>
                            </div>
                            <div class="space-y-3">
                                <div class="grid grid-cols-5 gap-4">
                                    <div class="h-4 bg-gray-300 dark:bg-gray-600 rounded"></div>
                                    <div class="h-4 bg-gray-300 dark:bg-gray-600 rounded"></div>
                                    <div class="h-4 bg-gray-300 dark:bg-gray-600 rounded"></div>
                                    <div class="h-4 bg-gray-300 dark:bg-gray-600 rounded"></div>
                                    <div class="h-4 bg-gray-300 dark:bg-gray-600 rounded"></div>
                                </div>
                                <div x-data="{}" x-init="() => { for(let i = 0; i < 5; i++) { setTimeout(() => { $el.appendChild($el.firstElementChild.cloneNode(true)) }, i * 200) } }">
                                    <div class="grid grid-cols-5 gap-4">
                                        <div class="h-12 bg-gray-200 dark:bg-gray-700 rounded"></div>
                                        <div class="h-12 bg-gray-200 dark:bg-gray-700 rounded"></div>
                                        <div class="h-12 bg-gray-200 dark:bg-gray-700 rounded"></div>
                                        <div class="h-12 bg-gray-200 dark:bg-gray-700 rounded"></div>
                                        <div class="h-12 bg-gray-200 dark:bg-gray-700 rounded"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 text-center">
                                <div class="inline-flex items-center text-sm text-gray-500 dark:text-gray-400">
                                    <svg class="animate-spin -ml-1 mr-2 h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                    Analyzing organizations...
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Classification Results -->
                    <div x-show="classificationResults.length > 0" class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 animate-slide-up">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Classification Results</h3>
                                <div class="flex items-center space-x-4">
                                    <span class="text-sm text-gray-600 dark:text-gray-400" x-text="`${classificationResults.length} results`"></span>
                                    <input type="text" placeholder="Search organizations..." 
                                           class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                                           x-model="searchQuery" @input="filterResults()">
                                </div>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600" @click="sortResults('name')">
                                                Organization
                                                <span x-show="sortField === 'name'" class="ml-1">
                                                    <span x-show="sortDirection === 'asc'">‚Üë</span>
                                                    <span x-show="sortDirection === 'desc'">‚Üì</span>
                                                </span>
                                            </th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600" @click="sortResults('composite_score')">
                                                Score
                                                <span x-show="sortField === 'composite_score'" class="ml-1">
                                                    <span x-show="sortDirection === 'asc'">‚Üë</span>
                                                    <span x-show="sortDirection === 'desc'">‚Üì</span>
                                                </span>
                                            </th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Category</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Qualification</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Location</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        <template x-for="result in filteredResults.slice(0, 50)" :key="result.ein">
                                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200">
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm font-medium text-gray-900 dark:text-white" x-text="result.name"></div>
                                                    <div class="text-sm text-gray-500 dark:text-gray-400" x-text="result.ein"></div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm font-semibold text-gray-900 dark:text-white" x-text="(result.composite_score || 0).toFixed(3)"></div>
                                                    <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-1 mt-1">
                                                        <div class="bg-blue-600 h-1 rounded-full transition-all duration-300" 
                                                             :style="`width: ${(result.composite_score || 0) * 100}%`"></div>
                                                    </div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200"
                                                          x-text="result.predicted_category || 'N/A'"></span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm text-gray-900 dark:text-white" x-text="result.primary_qualification_reason || 'N/A'"></div>
                                                    <div class="text-sm text-gray-500 dark:text-gray-400" x-text="result.qualification_strength || ''"></div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                                    <span x-text="(result.city || '') + ', ' + (result.state || '')"></span>
                                                </td>
                                            </tr>
                                        </template>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Workflows Tab -->
                <div x-show="activeTab === 'workflows'" class="space-y-6">
                    
                    <!-- New Workflow Form -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center">
                            <span class="text-2xl mr-3">üöÄ</span>
                            Create New Workflow
                        </h3>
                        
                        <form @submit.prevent="startWorkflow()" class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Workflow Type</label>
                                    <select x-model="workflowParams.type" class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                        <option value="standard">Standard Grant Research</option>
                                        <option value="classification">Intelligent Classification</option>
                                        <option value="analytics">Advanced Analytics</option>
                                        <option value="combined">Combined Analysis</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Target State</label>
                                    <select x-model="workflowParams.state" class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                        <option value="VA">Virginia</option>
                                        <option value="MD">Maryland</option>
                                        <option value="DC">District of Columbia</option>
                                        <option value="NC">North Carolina</option>
                                        <option value="WV">West Virginia</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Maximum Results</label>
                                    <input type="number" x-model="workflowParams.maxResults" min="1" max="10000" 
                                           class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Minimum Revenue</label>
                                    <input type="number" x-model="workflowParams.minRevenue" min="0" step="1000"
                                           class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">NTEE Codes (Health & Nutrition Focus)</label>
                                <div class="grid grid-cols-3 md:grid-cols-7 gap-2">
                                    <template x-for="code in availableNteeCodes" :key="code.code">
                                        <label class="flex items-center p-2 border dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer">
                                            <input type="checkbox" :value="code.code" x-model="workflowParams.nteeCodes" 
                                                   class="rounded border-gray-300 dark:border-gray-600 mr-2">
                                            <div>
                                                <div class="text-sm font-medium" x-text="code.code"></div>
                                                <div class="text-xs text-gray-500 dark:text-gray-400" x-text="code.name"></div>
                                            </div>
                                        </label>
                                    </template>
                                </div>
                            </div>
                            
                            <div class="flex items-center space-x-4">
                                <label class="flex items-center">
                                    <input type="checkbox" x-model="workflowParams.includeClassified" 
                                           class="rounded border-gray-300 dark:border-gray-600 mr-2">
                                    <span class="text-sm text-gray-700 dark:text-gray-300">Include intelligent classification</span>
                                </label>
                                
                                <label class="flex items-center">
                                    <input type="checkbox" x-model="workflowParams.exportResults" 
                                           class="rounded border-gray-300 dark:border-gray-600 mr-2">
                                    <span class="text-sm text-gray-700 dark:text-gray-300">Auto-export results</span>
                                </label>
                            </div>
                            
                            <div class="pt-4 border-t dark:border-gray-700">
                                <button type="submit" 
                                        :disabled="isRunningWorkflow"
                                        :class="isRunningWorkflow ? 'bg-gray-400 cursor-not-allowed' : 'bg-primary-600 hover:bg-primary-700 hover:scale-105'"
                                        class="px-8 py-3 text-white rounded-md font-medium transition-all duration-200 transform flex items-center">
                                    <span x-show="!isRunningWorkflow" class="flex items-center">
                                        <span class="mr-2">üöÄ</span> Start Workflow
                                    </span>
                                    <span x-show="isRunningWorkflow" class="flex items-center">
                                        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                        Processing...
                                    </span>
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Processor Controls -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center">
                            <span class="text-2xl mr-3">‚öôÔ∏è</span>
                            Advanced Processor Controls
                        </h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <!-- Government Scoring -->
                            <div class="p-4 border border-gray-200 dark:border-gray-600 rounded-lg">
                                <h4 class="font-medium text-gray-900 dark:text-white mb-3">Government Scoring</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-center justify-between">
                                        <span>Grants.gov Integration</span>
                                        <span class="text-green-600 dark:text-green-400">‚úì Active</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span>USASpending.gov</span>
                                        <span class="text-green-600 dark:text-green-400">‚úì Active</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span>Opportunity Scorer</span>
                                        <span class="text-green-600 dark:text-green-400">‚úì Ready</span>
                                    </div>
                                </div>
                                <button class="w-full mt-3 px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700">
                                    Run Government Analysis
                                </button>
                            </div>

                            <!-- Document Processing -->
                            <div class="p-4 border border-gray-200 dark:border-gray-600 rounded-lg">
                                <h4 class="font-medium text-gray-900 dark:text-white mb-3">Document Processing</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-center justify-between">
                                        <span>XML Downloader</span>
                                        <span class="text-green-600 dark:text-green-400">‚úì Ready</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span>PDF Downloader</span>
                                        <span class="text-green-600 dark:text-green-400">‚úì Ready</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span>OCR Processing</span>
                                        <span class="text-green-600 dark:text-green-400">‚úì Ready</span>
                                    </div>
                                </div>
                                <button class="w-full mt-3 px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700">
                                    Process Documents
                                </button>
                            </div>

                            <!-- Data Validation -->
                            <div class="p-4 border border-gray-200 dark:border-gray-600 rounded-lg">
                                <h4 class="font-medium text-gray-900 dark:text-white mb-3">Data Validation</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex items-center justify-between">
                                        <span>EIN Cross-Reference</span>
                                        <span class="text-green-600 dark:text-green-400">‚úì Active</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span>Schedule I Processor</span>
                                        <span class="text-green-600 dark:text-green-400">‚úì Ready</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span>Data Integrity Check</span>
                                        <span class="text-yellow-600 dark:text-yellow-400">‚ö† Manual</span>
                                    </div>
                                </div>
                                <button class="w-full mt-3 px-3 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700">
                                    Validate Data
                                </button>
                            </div>
                        </div>
                        
                        <!-- All Processors Status -->
                        <div class="mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <h4 class="font-medium text-gray-900 dark:text-white mb-3">System Status - 18 Processors</h4>
                            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-2 text-sm">
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">EIN Lookup</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">BMF Filter</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">ProPublica</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">Financial Scorer</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">Classifier</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">Trend Analysis</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">Risk Assessor</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">Network Analysis</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">Competitive Intel</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">Grants.gov</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">USASpending</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-gray-700 dark:text-gray-300">XML/PDF/OCR</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Active Workflows -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 animate-fade-in">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white flex items-center">
                                    <span class="text-2xl mr-3">‚ö°</span>
                                    Active Workflows
                                </h3>
                                <button @click="loadWorkflows()" class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300">
                                    Refresh
                                </button>
                            </div>
                        </div>
                        
                        <div class="p-6">
                            <div x-show="activeWorkflowsList.length === 0" class="text-center text-gray-500 dark:text-gray-400 py-8">
                                <div class="text-4xl mb-4">üí§</div>
                                <p>No active workflows</p>
                                <p class="text-sm mt-2">Start a new workflow above to begin processing</p>
                            </div>
                            
                            <div x-show="activeWorkflowsList.length > 0" class="space-y-4">
                                <template x-for="workflow in activeWorkflowsList" :key="workflow.workflow_id">
                                    <div class="border dark:border-gray-600 rounded-lg p-4 hover:shadow-md dark:hover:shadow-gray-900/50 transition-all duration-200">
                                        <div class="flex items-center justify-between mb-3">
                                            <div class="flex items-center">
                                                <div class="w-3 h-3 bg-green-400 rounded-full mr-3 animate-pulse"></div>
                                                <h4 class="font-semibold text-gray-900 dark:text-white" x-text="workflow.name || workflow.workflow_id"></h4>
                                            </div>
                                            <div class="flex items-center space-x-2">
                                                <span class="px-2 py-1 bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200 text-xs rounded-full font-medium"
                                                      x-text="workflow.status"></span>
                                                <button @click="stopWorkflow(workflow.workflow_id)" 
                                                        class="text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 text-sm">
                                                    Stop
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                                            <div>
                                                <span class="text-gray-600 dark:text-gray-400">Type:</span>
                                                <span class="font-medium ml-1" x-text="workflow.type || 'Standard'"></span>
                                            </div>
                                            <div>
                                                <span class="text-gray-600 dark:text-gray-400">Progress:</span>
                                                <span class="font-medium ml-1">
                                                    <span x-text="workflow.processed_count || 0"></span>/<span x-text="workflow.total_count || 0"></span>
                                                </span>
                                            </div>
                                            <div>
                                                <span class="text-gray-600 dark:text-gray-400">Speed:</span>
                                                <span class="font-medium ml-1" x-text="(workflow.processing_speed || 0).toFixed(1)"></span> orgs/sec
                                            </div>
                                            <div>
                                                <span class="text-gray-600 dark:text-gray-400">Started:</span>
                                                <span class="font-medium ml-1" x-text="formatTimeAgo(workflow.started_at)"></span>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-3">
                                            <div class="flex justify-between text-sm mb-1">
                                                <span class="text-gray-600 dark:text-gray-400">Progress</span>
                                                <span class="font-medium" x-text="Math.round(workflow.progress_percentage || 0)"></span>%
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2">
                                                <div class="bg-blue-600 h-2 rounded-full transition-all duration-300" 
                                                     :style="`width: ${workflow.progress_percentage || 0}%`"></div>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Workflow History -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 animate-fade-in">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white flex items-center">
                                <span class="text-2xl mr-3">üìö</span>
                                Workflow History
                            </h3>
                        </div>
                        
                        <div class="p-6">
                            <div x-show="workflowHistory.length === 0" class="text-center text-gray-500 dark:text-gray-400 py-8">
                                No completed workflows
                            </div>
                            
                            <div x-show="workflowHistory.length > 0" class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Workflow</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Type</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Results</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Status</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Completed</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        <template x-for="workflow in workflowHistory.slice(0, 10)" :key="workflow.workflow_id">
                                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200">
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm font-medium text-gray-900 dark:text-white" x-text="workflow.name || workflow.workflow_id"></div>
                                                    <div class="text-sm text-gray-500 dark:text-gray-400" x-text="workflow.workflow_id"></div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white" x-text="workflow.type || 'Standard'"></td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white" x-text="workflow.organizations_processed || 0"></td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <span :class="workflow.status === 'completed' ? 'bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200' : 
                                                                 workflow.status === 'error' ? 'bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-200' : 
                                                                 'bg-gray-100 dark:bg-gray-900/50 text-gray-800 dark:text-gray-200'"
                                                          class="px-2 py-1 text-xs font-semibold rounded-full" x-text="workflow.status"></span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400" x-text="formatTimeAgo(workflow.completed_at)"></td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm space-x-2">
                                                    <button @click="viewWorkflowResults(workflow.workflow_id)" 
                                                            class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300">
                                                        View
                                                    </button>
                                                    <button @click="exportWorkflow(workflow.workflow_id)" 
                                                            class="text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300">
                                                        Export
                                                    </button>
                                                </td>
                                            </tr>
                                        </template>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Profiles Tab -->
                <div x-show="activeTab === 'profiles'" class="space-y-6">
                    <!-- Profile Management Header -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 transition-all duration-300 animate-fade-in">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white flex items-center">
                                <span class="text-2xl mr-3">üë§</span>
                                Organization Profiles
                            </h3>
                            <div class="flex space-x-3">
                                <button @click="showCreateProfile = true" 
                                        class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors flex items-center">
                                    <span class="text-lg mr-2">‚ûï</span>
                                    Create Profile
                                </button>
                                <button @click="loadProfiles()" 
                                        class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors flex items-center">
                                    <span class="text-lg mr-2">üîÑ</span>
                                    Refresh
                                </button>
                            </div>
                        </div>
                        
                        <!-- Profile Stats - Compact -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-2">
                            <div class="bg-gray-50 dark:bg-gray-700 p-2 rounded-lg">
                                <div class="flex items-center justify-between">
                                    <span class="text-lg font-bold text-gray-900 dark:text-white" x-text="profileStats.total || 0"></span>
                                    <span class="text-sm font-bold text-gray-600 dark:text-gray-400">Total Profiles</span>
                                </div>
                            </div>
                            <div class="bg-green-50 dark:bg-green-900/20 p-2 rounded-lg">
                                <div class="flex items-center justify-between">
                                    <span class="text-lg font-bold text-green-600 dark:text-green-400" x-text="profileStats.active || 0"></span>
                                    <span class="text-sm font-bold text-gray-600 dark:text-gray-400">Active Profiles</span>
                                </div>
                            </div>
                            <div class="bg-blue-50 dark:bg-blue-900/20 p-2 rounded-lg">
                                <div class="flex items-center justify-between">
                                    <span class="text-lg font-bold text-blue-600 dark:text-blue-400" x-text="profileStats.opportunities || 0"></span>
                                    <span class="text-sm font-bold text-gray-600 dark:text-gray-400">Total Opportunities</span>
                                </div>
                            </div>
                            <div class="bg-purple-50 dark:bg-purple-900/20 p-2 rounded-lg">
                                <div class="flex items-center justify-between">
                                    <span class="text-lg font-bold text-purple-600 dark:text-purple-400" x-text="profileStats.templates || 0"></span>
                                    <span class="text-sm font-bold text-gray-600 dark:text-gray-400">Templates</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Create Profile Modal -->
                    <div x-show="showCreateProfile" 
                         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
                         x-transition:enter="transition ease-out duration-300"
                         x-transition:enter-start="opacity-0"
                         x-transition:enter-end="opacity-100"
                         x-transition:leave="transition ease-in duration-200"
                         x-transition:leave-start="opacity-100"
                         x-transition:leave-end="opacity-0">
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"
                             x-transition:enter="transition ease-out duration-300 transform"
                             x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
                             x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
                             x-transition:leave="transition ease-in duration-200 transform"
                             x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
                             x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95">
                            
                            <!-- Modal Header -->
                            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Create Organization Profile</h3>
                                <button @click="showCreateProfile = false" 
                                        class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                                    <span class="text-2xl">&times;</span>
                                </button>
                            </div>
                            
                            <!-- Profile Creation Form -->
                            <form @submit.prevent="createProfile()" class="p-6 space-y-6">
                                <!-- Basic Information -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Organization Name *
                                        </label>
                                        <input type="text" x-model="profileForm.name" required
                                               class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                               placeholder="Enter organization name">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Organization Type *
                                        </label>
                                        <select x-model="profileForm.organization_type" required
                                                class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                            <option value="">Select type</option>
                                            <option value="nonprofit">Nonprofit</option>
                                            <option value="for_profit">For Profit</option>
                                            <option value="government">Government</option>
                                            <option value="academic">Academic</option>
                                            <option value="healthcare">Healthcare</option>
                                            <option value="foundation">Foundation</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        EIN (Tax ID)
                                    </label>
                                    <input type="text" x-model="profileForm.ein"
                                           class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                           placeholder="XX-XXXXXXX (optional)">
                                </div>
                                
                                <!-- Mission and Focus -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Mission Statement *
                                    </label>
                                    <textarea x-model="profileForm.mission_statement" required rows="3"
                                              class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                              placeholder="Describe your organization's mission and purpose"></textarea>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Focus Areas * (comma-separated)
                                        </label>
                                        <input type="text" x-model="profileForm.focus_areas" required
                                               class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                               placeholder="health, education, community development">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Target Populations (comma-separated)
                                        </label>
                                        <input type="text" x-model="profileForm.target_populations"
                                               class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                               placeholder="youth, seniors, low-income families">
                                    </div>
                                </div>
                                
                                <!-- Geographic Scope -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Target States (comma-separated)
                                        </label>
                                        <input type="text" x-model="profileForm.states"
                                               class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                               placeholder="VA, MD, DC">
                                    </div>
                                    <div class="flex items-center space-x-4 pt-6">
                                        <label class="flex items-center">
                                            <input type="checkbox" x-model="profileForm.nationwide"
                                                   class="rounded border-gray-300 text-primary-600 shadow-sm">
                                            <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Nationwide</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" x-model="profileForm.international"
                                                   class="rounded border-gray-300 text-primary-600 shadow-sm">
                                            <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">International</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Funding Preferences -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Min Funding Amount
                                        </label>
                                        <input type="number" x-model="profileForm.min_amount" min="0"
                                               class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                               placeholder="50000">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Max Funding Amount
                                        </label>
                                        <input type="number" x-model="profileForm.max_amount" min="0"
                                               class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                               placeholder="500000">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Annual Revenue/Budget
                                        </label>
                                        <input type="number" x-model="profileForm.annual_revenue" min="0"
                                               class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                               placeholder="1000000">
                                    </div>
                                </div>
                                
                                <!-- Funding Type Preferences -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Preferred Funding Types
                                    </label>
                                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                                        <label class="flex items-center">
                                            <input type="checkbox" value="grants" x-model="profileForm.funding_types"
                                                   class="rounded border-gray-300 text-primary-600 shadow-sm">
                                            <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Grants</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" value="government" x-model="profileForm.funding_types"
                                                   class="rounded border-gray-300 text-primary-600 shadow-sm">
                                            <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Government</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" value="commercial" x-model="profileForm.funding_types"
                                                   class="rounded border-gray-300 text-primary-600 shadow-sm">
                                            <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Commercial</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" value="sponsorships" x-model="profileForm.funding_types"
                                                   class="rounded border-gray-300 text-primary-600 shadow-sm">
                                            <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Sponsorships</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" value="partnerships" x-model="profileForm.funding_types"
                                                   class="rounded border-gray-300 text-primary-600 shadow-sm">
                                            <span class="ml-2 text-sm text-gray-700 dark:text-gray-300">Partnerships</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- Form Actions -->
                                <div class="flex justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700">
                                    <button type="button" @click="showCreateProfile = false"
                                            class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                                        Cancel
                                    </button>
                                    <button type="button" @click="saveProfileTemplate()"
                                            class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                                        Save as Template
                                    </button>
                                    <button type="submit" 
                                            :disabled="!profileForm.name || !profileForm.organization_type || !profileForm.mission_statement || !profileForm.focus_areas"
                                            class="px-6 py-2 bg-primary-600 hover:bg-primary-700 disabled:bg-gray-400 text-white rounded-md text-sm font-medium transition-colors">
                                        Create Profile
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Profiles List -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 animate-fade-in">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">My Profiles</h3>
                                <div class="flex items-center space-x-4">
                                    <span class="text-sm text-gray-600 dark:text-gray-400" x-text="`${profiles.length} profiles`"></span>
                                    <input type="text" placeholder="Search profiles..." 
                                           class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                                           x-model="profileSearchQuery" @input="filterProfiles()">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Profile Status Filters -->
                        <div class="px-6 py-3 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex items-center space-x-2" x-data="{ profileStatusFilter: 'all' }">
                                <span class="text-sm text-gray-600 dark:text-gray-400 mr-3">Filter by status:</span>
                                <button @click="profileStatusFilter = 'all'; filterProfiles()" 
                                        :class="profileStatusFilter === 'all' ? 'bg-primary-600 text-white' : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'"
                                        class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors">
                                    All
                                </button>
                                <button @click="profileStatusFilter = 'active'; filterProfiles()" 
                                        :class="profileStatusFilter === 'active' ? 'bg-primary-600 text-white' : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'"
                                        class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors">
                                    Active
                                </button>
                                <button @click="profileStatusFilter = 'archived'; filterProfiles()" 
                                        :class="profileStatusFilter === 'archived' ? 'bg-primary-600 text-white' : 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 hover:bg-yellow-200 dark:hover:bg-yellow-800'"
                                        class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors">
                                    Archived
                                </button>
                                <button @click="profileStatusFilter = 'draft'; filterProfiles()" 
                                        :class="profileStatusFilter === 'draft' ? 'bg-primary-600 text-white' : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'"
                                        class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors">
                                    Draft
                                </button>
                            </div>
                        </div>
                        
                        <!-- Profiles Table -->
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Organization</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Type</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Focus Areas</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Opportunities</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                                    <template x-for="profile in filteredProfiles" :key="profile.profile_id">
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <div>
                                                    <div class="text-sm font-medium text-gray-900 dark:text-white" x-text="profile.name"></div>
                                                    <div class="text-sm text-gray-500 dark:text-gray-400" x-text="profile.ein || 'No EIN'"></div>
                                                </div>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200" 
                                                      x-text="profile.organization_type"></span>
                                            </td>
                                            <td class="px-6 py-4">
                                                <div class="text-sm text-gray-900 dark:text-white" x-text="profile.focus_areas?.join(', ') || 'None specified'"></div>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                                <span x-text="profile.opportunities_count || 0"></span> leads
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span :class="profile.status === 'active' ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200' : 
                                                               profile.status === 'draft' ? 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200' : 
                                                               'bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200'"
                                                      class="px-2 py-1 text-xs font-medium rounded-full" 
                                                      x-text="profile.status"></span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm space-x-2">
                                                <button @click="viewProfile(profile)" class="text-primary-600 hover:text-primary-800 font-medium">View</button>
                                                <button @click="editProfile(profile)" class="text-blue-600 hover:text-blue-800 font-medium">Edit</button>
                                                <button @click="discoverOpportunities(profile)" 
                                                        class="text-green-600 hover:text-green-800 font-medium flex items-center space-x-1"
                                                        :class="{'opacity-50 cursor-not-allowed': processorControls.discombobulator.running || processorControls.amplinator.running}">
                                                    <span>üöÄ Discover</span>
                                                    <span v-if="processorControls.discombobulator.running || processorControls.amplinator.running" class="text-xs">Running...</span>
                                                </button>
                                            </td>
                                        </tr>
                                    </template>
                                    <tr x-show="filteredProfiles.length === 0">
                                        <td colspan="6" class="px-6 py-8 text-center text-gray-500 dark:text-gray-400">
                                            <div class="text-4xl mb-4">üìù</div>
                                            <div>No profiles found. Create your first organization profile to get started!</div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- View Profile Modal -->
                    <div x-show="showViewProfile" 
                         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto">
                            <!-- Modal Header -->
                            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                                <h3 class="text-xl font-semibold text-gray-900 dark:text-white flex items-center">
                                    <span class="text-2xl mr-3">üëÅÔ∏è</span>
                                    Profile Details
                                </h3>
                                <button @click="closeViewProfile()" 
                                        class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                                    <span class="text-2xl">&times;</span>
                                </button>
                            </div>
                            
                            <!-- Modal Content -->
                            <div class="p-6 space-y-6" x-show="selectedProfile">
                                <!-- Organization Info -->
                                <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-3" x-text="selectedProfile?.name || 'Organization'"></h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <span class="text-sm font-medium text-gray-500 dark:text-gray-400">EIN:</span>
                                            <p class="text-gray-900 dark:text-white font-mono" x-text="selectedProfile?.ein || 'Not provided'"></p>
                                        </div>
                                        <div>
                                            <span class="text-sm font-medium text-gray-500 dark:text-gray-400">Status:</span>
                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ml-2"
                                                  :class="selectedProfile?.status === 'active' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' : 
                                                         selectedProfile?.status === 'archived' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200' :
                                                         'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200'"
                                                  x-text="selectedProfile?.status || 'Unknown'"></span>
                                        </div>
                                        <div>
                                            <span class="text-sm font-medium text-gray-500 dark:text-gray-400">Type:</span>
                                            <p class="text-gray-900 dark:text-white" x-text="selectedProfile?.organization_type || 'Not specified'"></p>
                                        </div>
                                        <div>
                                            <span class="text-sm font-medium text-gray-500 dark:text-gray-400">Opportunities:</span>
                                            <p class="text-gray-900 dark:text-white" x-text="(selectedProfile?.opportunities_count || 0) + ' leads'"></p>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Mission & Focus -->
                                <div>
                                    <h5 class="text-md font-semibold text-gray-900 dark:text-white mb-2">Mission Statement</h5>
                                    <p class="text-gray-700 dark:text-gray-300" x-text="selectedProfile?.mission_statement || 'Not provided'"></p>
                                </div>
                                
                                <div>
                                    <h5 class="text-md font-semibold text-gray-900 dark:text-white mb-2">Focus Areas</h5>
                                    <p class="text-gray-700 dark:text-gray-300" x-text="selectedProfile?.focus_areas || 'Not specified'"></p>
                                </div>
                            </div>
                            
                            <!-- Modal Footer -->
                            <div class="flex items-center justify-between px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                                <button @click="editProfile(selectedProfile)" 
                                        class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors">
                                    Edit Profile
                                </button>
                                <button @click="closeViewProfile()" 
                                        class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                                    Close
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Edit Profile Modal -->
                    <div x-show="showEditProfile" 
                         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto">
                            <!-- Modal Header -->
                            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                                <h3 class="text-xl font-semibold text-gray-900 dark:text-white flex items-center">
                                    <span class="text-2xl mr-3">‚úèÔ∏è</span>
                                    Edit Profile
                                </h3>
                                <button @click="closeEditProfile()" 
                                        class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                                    <span class="text-2xl">&times;</span>
                                </button>
                            </div>
                            
                            <!-- Modal Content -->
                            <div class="p-6 space-y-6" x-show="selectedProfile">
                                <!-- Organization Info -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Organization Name *
                                        </label>
                                        <input type="text" x-model="selectedProfile.name" required
                                               class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            EIN (Tax ID)
                                        </label>
                                        <input type="text" x-model="selectedProfile.ein"
                                               class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white font-mono"
                                               placeholder="XX-XXXXXXX">
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Organization Type *
                                        </label>
                                        <select x-model="selectedProfile.organization_type" required
                                                class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                            <option value="nonprofit">Nonprofit</option>
                                            <option value="government">Government</option>
                                            <option value="educational">Educational Institution</option>
                                            <option value="healthcare">Healthcare</option>
                                            <option value="foundation">Foundation</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Status
                                        </label>
                                        <select x-model="selectedProfile.status"
                                                class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                            <option value="active">Active</option>
                                            <option value="archived">Archived</option>
                                            <option value="draft">Draft</option>
                                            <option value="template">Template</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Mission Statement *
                                    </label>
                                    <textarea x-model="selectedProfile.mission_statement" required rows="3"
                                              class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                              placeholder="Describe the organization's mission and purpose"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Focus Areas * (comma-separated)
                                    </label>
                                    <input type="text" x-model="selectedProfile.focus_areas" required
                                           class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white"
                                           placeholder="health, education, community development">
                                </div>
                            </div>
                            
                            <!-- Modal Footer -->
                            <div class="flex items-center justify-between px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                                <div class="space-x-3">
                                    <button @click="deleteProfile()" 
                                            class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors">
                                        Delete Profile
                                    </button>
                                    <button @click="archiveProfile()" 
                                            class="px-4 py-2 text-sm font-medium text-white bg-yellow-600 rounded-md hover:bg-yellow-700 transition-colors">
                                        Archive
                                    </button>
                                </div>
                                <div class="space-x-3">
                                    <button @click="closeEditProfile()" 
                                            class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                                        Cancel
                                    </button>
                                    <button @click="saveProfileChanges()" 
                                            class="px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 transition-colors">
                                        Save Changes
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Analytics Tab -->
                <div x-show="activeTab === 'analytics'" class="space-y-6">
                    
                    <!-- Enhanced Analytics Charts -->
                    <div class="grid grid-cols-1 xl:grid-cols-3 gap-6 mb-6">
                        <!-- Revenue Growth Chart -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Revenue Growth Trends</h3>
                            <div class="h-64 flex items-center justify-center">
                                <canvas id="revenueChart" class="w-full h-full"></canvas>
                            </div>
                        </div>
                        
                        <!-- Risk Distribution Chart -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Risk Distribution</h3>
                            <div class="h-64 flex items-center justify-center">
                                <canvas id="riskChart" class="w-full h-full"></canvas>
                            </div>
                        </div>
                        
                        <!-- Success Rate Trends -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Success Rate Trends</h3>
                            <div class="h-64 flex items-center justify-center">
                                <canvas id="successRateChart" class="w-full h-full"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Analytics Overview Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Processing Trends</h3>
                                <span class="text-2xl">üìä</span>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Today</span>
                                    <span class="font-medium" x-text="analyticsData.todaysProcessed || 0"></span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">This Week</span>
                                    <span class="font-medium" x-text="analyticsData.weekProcessed || 0"></span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Success Rate</span>
                                    <span class="font-medium">
                                        <span x-text="((analyticsData.successRate || 0) * 100).toFixed(1)"></span>%
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Performance Metrics</h3>
                                <span class="text-2xl">‚ö°</span>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Avg Processing Speed</span>
                                    <span class="font-medium" x-text="(analyticsData.avgSpeed || 0).toFixed(1)"></span> orgs/sec
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">API Success Rate</span>
                                    <span class="font-medium">
                                        <span x-text="((analyticsData.apiSuccessRate || 0) * 100).toFixed(1)"></span>%
                                    </span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Avg Response Time</span>
                                    <span class="font-medium" x-text="(analyticsData.avgResponseTime || 0).toFixed(0)"></span>ms
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Quality Metrics</h3>
                                <span class="text-2xl">üéØ</span>
                            </div>
                            <div class="space-y-3">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">High Score Orgs</span>
                                    <span class="font-medium" x-text="analyticsData.highScoreOrgs || 0"></span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Avg Composite Score</span>
                                    <span class="font-medium" x-text="(analyticsData.avgCompositeScore || 0).toFixed(3)"></span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Classification Accuracy</span>
                                    <span class="font-medium">
                                        <span x-text="((analyticsData.classificationAccuracy || 0) * 100).toFixed(1)"></span>%
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Charts Section -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Processing Volume Chart -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Processing Volume</h3>
                                <div class="flex space-x-2">
                                    <button @click="chartTimeRange = '7d'; loadAnalytics()" 
                                            :class="chartTimeRange === '7d' ? 'bg-blue-500 text-white' : 'bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300'"
                                            class="px-3 py-1 text-xs rounded-md">7D</button>
                                    <button @click="chartTimeRange = '30d'; loadAnalytics()" 
                                            :class="chartTimeRange === '30d' ? 'bg-blue-500 text-white' : 'bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300'"
                                            class="px-3 py-1 text-xs rounded-md">30D</button>
                                </div>
                            </div>
                            <div class="h-64">
                                <canvas id="processingVolumeChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                        
                        <!-- Success Rate Chart -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                            <div class="flex items-center justify-between mb-6">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Success Rate Trends</h3>
                                <span class="text-sm text-gray-500 dark:text-gray-400">Last 30 days</span>
                            </div>
                            <div class="h-64">
                                <canvas id="successRateChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- NTEE Code Distribution -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">NTEE Code Distribution</h3>
                            <button @click="loadAnalytics()" class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300">
                                Refresh
                            </button>
                        </div>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <template x-for="ntee in analyticsData.nteeDistribution || []" :key="ntee.code">
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-gray-900 dark:text-white" x-text="ntee.count"></div>
                                    <div class="text-sm font-medium text-gray-700 dark:text-gray-300" x-text="ntee.code"></div>
                                    <div class="text-xs text-gray-500 dark:text-gray-400" x-text="ntee.name"></div>
                                    <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 mt-2">
                                        <div class="bg-blue-600 h-2 rounded-full transition-all duration-300" 
                                             :style="`width: ${ntee.percentage}%`"></div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                    
                    <!-- Top Performing Organizations -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 animate-fade-in">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Top Performing Organizations</h3>
                        </div>
                        <div class="p-6">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Organization</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Score</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">NTEE Code</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Revenue</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Location</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        <template x-for="org in analyticsData.topOrganizations || []" :key="org.ein">
                                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200">
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm font-medium text-gray-900 dark:text-white" x-text="org.name"></div>
                                                    <div class="text-sm text-gray-500 dark:text-gray-400" x-text="org.ein"></div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="text-sm font-semibold text-gray-900 dark:text-white" x-text="(org.composite_score || 0).toFixed(3)"></div>
                                                    <div class="w-16 bg-gray-200 dark:bg-gray-600 rounded-full h-1 mt-1">
                                                        <div class="bg-green-600 h-1 rounded-full transition-all duration-300" 
                                                             :style="`width: ${(org.composite_score || 0) * 100}%`"></div>
                                                    </div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200"
                                                          x-text="org.ntee_code || 'N/A'"></span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                                                    $<span x-text="(org.revenue || 0).toLocaleString()"></span>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                                                    <span x-text="(org.city || '') + ', ' + (org.state || '')"></span>
                                                </td>
                                            </tr>
                                        </template>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Predictive Analytics Tab -->
                <div x-show="activeTab === 'predictive'" class="space-y-6">
                    <!-- Header -->
                    <div class="bg-gradient-to-r from-purple-600 to-indigo-600 rounded-lg p-6 text-white">
                        <h3 class="text-2xl font-bold">Predictive Success Analytics</h3>
                        <p class="mt-2 opacity-90">AI-powered success prediction and opportunity scoring</p>
                    </div>

                    <!-- Model Status and Controls -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-4">Model Status</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between"><span>Model Version:</span><span class="font-medium">v2.1.0</span></div>
                                <div class="flex justify-between"><span>Accuracy:</span><span class="font-medium text-green-600">87.3%</span></div>
                                <div class="flex justify-between"><span>Training Data:</span><span class="font-medium">15,247 records</span></div>
                                <div class="flex justify-between"><span>Last Updated:</span><span class="font-medium">2 hours ago</span></div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-4">Quick Prediction</h4>
                            <div class="space-y-3">
                                <select class="w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600">
                                    <option>Select Organization...</option>
                                    <option>Tech Nonprofit Foundation</option>
                                    <option>Healthcare Initiative</option>
                                    <option>Education Alliance</option>
                                </select>
                                <button class="w-full bg-purple-600 text-white py-2 rounded-md hover:bg-purple-700">
                                    Predict Success
                                </button>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-4">Model Actions</h4>
                            <div class="space-y-2">
                                <button class="w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700">
                                    Retrain Model
                                </button>
                                <button class="w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700">
                                    Validate Model
                                </button>
                                <button class="w-full bg-gray-600 text-white py-2 rounded-md hover:bg-gray-700">
                                    Export Predictions
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Success Score Breakdown -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                        <h4 class="text-lg font-semibold mb-6">Multi-Dimensional Success Scoring</h4>
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                            <div class="text-center">
                                <div class="w-20 h-20 mx-auto mb-3 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center">
                                    <div class="text-white font-bold text-lg">8.4</div>
                                </div>
                                <h5 class="font-medium">Financial Health</h5>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Revenue & Stability</p>
                            </div>
                            <div class="text-center">
                                <div class="w-20 h-20 mx-auto mb-3 rounded-full bg-gradient-to-br from-green-400 to-green-600 flex items-center justify-center">
                                    <div class="text-white font-bold text-lg">7.2</div>
                                </div>
                                <h5 class="font-medium">Capacity</h5>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Staff & Experience</p>
                            </div>
                            <div class="text-center">
                                <div class="w-20 h-20 mx-auto mb-3 rounded-full bg-gradient-to-br from-purple-400 to-purple-600 flex items-center justify-center">
                                    <div class="text-white font-bold text-lg">9.1</div>
                                </div>
                                <h5 class="font-medium">Alignment</h5>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Strategic Fit</p>
                            </div>
                            <div class="text-center">
                                <div class="w-20 h-20 mx-auto mb-3 rounded-full bg-gradient-to-br from-indigo-400 to-indigo-600 flex items-center justify-center">
                                    <div class="text-white font-bold text-lg">6.8</div>
                                </div>
                                <h5 class="font-medium">Network</h5>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Influence & Connections</p>
                            </div>
                            <div class="text-center">
                                <div class="w-20 h-20 mx-auto mb-3 rounded-full bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center">
                                    <div class="text-white font-bold text-lg">8.7</div>
                                </div>
                                <h5 class="font-medium">Track Record</h5>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Past Success</p>
                            </div>
                        </div>
                    </div>

                    <!-- Prediction Results -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-4">Recent Predictions</h4>
                            <div class="space-y-4">
                                <div class="border-l-4 border-green-500 pl-4">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <p class="font-medium">Virginia Community Health</p>
                                            <p class="text-sm text-gray-600">Healthcare Grant Application</p>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-green-600">89%</div>
                                            <div class="text-sm text-gray-500">Success Rate</div>
                                        </div>
                                    </div>
                                    <p class="text-sm mt-2 text-gray-600">Highly recommended - Strong financial health and perfect alignment</p>
                                </div>
                                
                                <div class="border-l-4 border-yellow-500 pl-4">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <p class="font-medium">Tech Education Initiative</p>
                                            <p class="text-sm text-gray-600">STEM Program Funding</p>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-yellow-600">67%</div>
                                            <div class="text-sm text-gray-500">Success Rate</div>
                                        </div>
                                    </div>
                                    <p class="text-sm mt-2 text-gray-600">Conditional - Need to strengthen track record and network</p>
                                </div>
                                
                                <div class="border-l-4 border-red-500 pl-4">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <p class="font-medium">Regional Arts Council</p>
                                            <p class="text-sm text-gray-600">Community Arts Grant</p>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-red-600">34%</div>
                                            <div class="text-sm text-gray-500">Success Rate</div>
                                        </div>
                                    </div>
                                    <p class="text-sm mt-2 text-gray-600">Not recommended - Financial instability and poor alignment</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-4">Improvement Recommendations</h4>
                            <div class="space-y-3">
                                <div class="p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                    <h5 class="font-medium text-blue-800 dark:text-blue-200">Financial Health</h5>
                                    <p class="text-sm text-blue-700 dark:text-blue-300">Diversify revenue streams to improve financial stability</p>
                                </div>
                                <div class="p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                    <h5 class="font-medium text-green-800 dark:text-green-200">Network Building</h5>
                                    <p class="text-sm text-green-700 dark:text-green-300">Build strategic board connections and partnerships</p>
                                </div>
                                <div class="p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
                                    <h5 class="font-medium text-purple-800 dark:text-purple-200">Capacity Development</h5>
                                    <p class="text-sm text-purple-700 dark:text-purple-300">Invest in leadership development and experienced hires</p>
                                </div>
                                <div class="p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg">
                                    <h5 class="font-medium text-orange-800 dark:text-orange-200">Track Record</h5>
                                    <p class="text-sm text-orange-700 dark:text-orange-300">Improve project management for better completion rates</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Model Performance Metrics -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                        <h4 class="text-lg font-semibold mb-4">Model Performance Analysis</h4>
                        <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                            <div class="text-center">
                                <div class="text-3xl font-bold text-blue-600">87.3%</div>
                                <div class="text-sm text-gray-600">Accuracy</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-green-600">84.7%</div>
                                <div class="text-sm text-gray-600">Precision</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-purple-600">91.2%</div>
                                <div class="text-sm text-gray-600">Recall</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-indigo-600">87.8%</div>
                                <div class="text-sm text-gray-600">F1-Score</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ROI Analytics Tab -->
                <div x-show="activeTab === 'roi'" class="space-y-6">
                    <!-- Header -->
                    <div class="bg-gradient-to-r from-green-600 to-teal-600 rounded-lg p-6 text-white">
                        <h3 class="text-2xl font-bold">ROI Analytics & Optimization</h3>
                        <p class="mt-2 opacity-90">Comprehensive return on investment tracking and portfolio optimization</p>
                    </div>

                    <!-- ROI Overview Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 text-center">
                            <div class="text-3xl font-bold text-green-600">287%</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400 mt-1">Portfolio ROI</div>
                            <div class="text-xs text-green-600 mt-1">+23% vs baseline</div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 text-center">
                            <div class="text-3xl font-bold text-blue-600">$2.4M</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400 mt-1">Expected Value</div>
                            <div class="text-xs text-blue-600 mt-1">15 opportunities</div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 text-center">
                            <div class="text-3xl font-bold text-purple-600">$847K</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400 mt-1">Total Investment</div>
                            <div class="text-xs text-purple-600 mt-1">Budget utilized: 84%</div>
                        </div>
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 text-center">
                            <div class="text-3xl font-bold text-orange-600">0.24</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400 mt-1">Risk Score</div>
                            <div class="text-xs text-green-600 mt-1">Low risk</div>
                        </div>
                    </div>

                    <!-- Portfolio Optimization -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-4">Portfolio Optimization</h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Optimization Method</label>
                                    <select class="w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600">
                                        <option value="portfolio_balanced">Portfolio Balanced (Recommended)</option>
                                        <option value="risk_adjusted">Risk Adjusted</option>
                                        <option value="greedy">Maximum ROI</option>
                                        <option value="linear_programming">Linear Programming</option>
                                        <option value="knapsack">Knapsack</option>
                                    </select>
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Budget Limit</label>
                                        <input type="number" placeholder="1000000" class="w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Risk Tolerance</label>
                                        <select class="w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600">
                                            <option value="low">Low (0.2)</option>
                                            <option value="medium" selected>Medium (0.4)</option>
                                            <option value="high">High (0.6)</option>
                                        </select>
                                    </div>
                                </div>
                                <button class="w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700">
                                    Optimize Portfolio
                                </button>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-4">Optimization Results</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm">Method Used:</span>
                                    <span class="font-medium">Portfolio Balanced</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm">Opportunities Selected:</span>
                                    <span class="font-medium">12 of 25</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm">Expected ROI:</span>
                                    <span class="font-medium text-green-600">287%</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm">Improvement:</span>
                                    <span class="font-medium text-blue-600">+23% vs baseline</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm">Diversification Index:</span>
                                    <span class="font-medium">0.73</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm">Confidence Score:</span>
                                    <span class="font-medium">0.89</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ROI Breakdown Analysis -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                        <h4 class="text-lg font-semibold mb-6">Multi-Dimensional ROI Analysis</h4>
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-6">
                            <div class="text-center">
                                <div class="w-24 h-24 mx-auto mb-3 relative">
                                    <svg class="w-24 h-24 transform -rotate-90">
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8" fill="transparent" class="text-gray-200 dark:text-gray-700"/>
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8" fill="transparent" stroke-dasharray="251.2" stroke-dashoffset="75.36" class="text-green-500"/>
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <span class="text-xl font-bold">3.2</span>
                                    </div>
                                </div>
                                <h5 class="font-medium">Financial ROI</h5>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Traditional Return</p>
                            </div>
                            <div class="text-center">
                                <div class="w-24 h-24 mx-auto mb-3 relative">
                                    <svg class="w-24 h-24 transform -rotate-90">
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8" fill="transparent" class="text-gray-200 dark:text-gray-700"/>
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8" fill="transparent" stroke-dasharray="251.2" stroke-dashoffset="100.48" class="text-blue-500"/>
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <span class="text-xl font-bold">2.4</span>
                                    </div>
                                </div>
                                <h5 class="font-medium">Time ROI</h5>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Time Efficiency</p>
                            </div>
                            <div class="text-center">
                                <div class="w-24 h-24 mx-auto mb-3 relative">
                                    <svg class="w-24 h-24 transform -rotate-90">
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8" fill="transparent" class="text-gray-200 dark:text-gray-700"/>
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8" fill="transparent" stroke-dasharray="251.2" stroke-dashoffset="87.92" class="text-purple-500"/>
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <span class="text-xl font-bold">2.8</span>
                                    </div>
                                </div>
                                <h5 class="font-medium">Resource Efficiency</h5>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Resource Utilization</p>
                            </div>
                            <div class="text-center">
                                <div class="w-24 h-24 mx-auto mb-3 relative">
                                    <svg class="w-24 h-24 transform -rotate-90">
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8" fill="transparent" class="text-gray-200 dark:text-gray-700"/>
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8" fill="transparent" stroke-dasharray="251.2" stroke-dashoffset="125.6" class="text-yellow-500"/>
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <span class="text-xl font-bold">1.9</span>
                                    </div>
                                </div>
                                <h5 class="font-medium">Opportunity Cost</h5>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Alternative Value</p>
                            </div>
                            <div class="text-center">
                                <div class="w-24 h-24 mx-auto mb-3 relative">
                                    <svg class="w-24 h-24 transform -rotate-90">
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8" fill="transparent" class="text-gray-200 dark:text-gray-700"/>
                                        <circle cx="48" cy="48" r="40" stroke="currentColor" stroke-width="8" fill="transparent" stroke-dasharray="251.2" stroke-dashoffset="62.8" class="text-indigo-500"/>
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <span class="text-xl font-bold">3.6</span>
                                    </div>
                                </div>
                                <h5 class="font-medium">Strategic Value</h5>
                                <p class="text-sm text-gray-600 dark:text-gray-400">Long-term Impact</p>
                            </div>
                        </div>
                    </div>

                    <!-- Top Performing Opportunities -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-4">Top ROI Opportunities</h4>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-3 border rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                                        <div>
                                            <p class="font-medium">Healthcare Innovation Grant</p>
                                            <p class="text-sm text-gray-600">$500K opportunity</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="font-bold text-green-600">425%</div>
                                        <div class="text-xs text-gray-500">ROI</div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between p-3 border rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                                        <div>
                                            <p class="font-medium">Education Technology Fund</p>
                                            <p class="text-sm text-gray-600">$300K opportunity</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="font-bold text-blue-600">387%</div>
                                        <div class="text-xs text-gray-500">ROI</div>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between p-3 border rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                                        <div>
                                            <p class="font-medium">Community Development</p>
                                            <p class="text-sm text-gray-600">$150K opportunity</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="font-bold text-purple-600">298%</div>
                                        <div class="text-xs text-gray-500">ROI</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-4">Optimization Recommendations</h4>
                            <div class="space-y-3">
                                <div class="p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                    <h5 class="font-medium text-green-800 dark:text-green-200">Portfolio Optimization</h5>
                                    <p class="text-sm text-green-700 dark:text-green-300">Current portfolio shows excellent diversification and ROI potential</p>
                                </div>
                                <div class="p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                    <h5 class="font-medium text-blue-800 dark:text-blue-200">Resource Allocation</h5>
                                    <p class="text-sm text-blue-700 dark:text-blue-300">Consider increasing budget allocation by 15% for maximum returns</p>
                                </div>
                                <div class="p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg">
                                    <h5 class="font-medium text-yellow-800 dark:text-yellow-200">Risk Management</h5>
                                    <p class="text-sm text-yellow-700 dark:text-yellow-300">Low risk profile allows for potentially higher return opportunities</p>
                                </div>
                                <div class="p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
                                    <h5 class="font-medium text-purple-800 dark:text-purple-200">Timeline Optimization</h5>
                                    <p class="text-sm text-purple-700 dark:text-purple-300">Stagger opportunity pursuit to maximize team efficiency</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Historical Performance -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-6">
                        <h4 class="text-lg font-semibold mb-4">Historical ROI Performance</h4>
                        <div class="grid grid-cols-2 lg:grid-cols-6 gap-4 text-center">
                            <div>
                                <div class="text-2xl font-bold text-gray-900 dark:text-white">23</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">Total Tracked</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-green-600">78%</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">Success Rate</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-blue-600">245%</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">Avg Actual ROI</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-purple-600">+12%</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">vs Predicted</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-indigo-600">$3.8M</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">Total Value</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-orange-600">0.19</div>
                                <div class="text-sm text-gray-600 dark:text-gray-400">Avg Risk</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exports Tab -->
                <div x-show="activeTab === 'exports'" class="space-y-6">
                    
                    <!-- Export Management -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center">
                            <span class="text-2xl mr-3">üìÅ</span>
                            Available Exports
                        </h3>
                        
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">File</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Type</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Size</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Created</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <template x-for="file in exportFiles" :key="file.filename">
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200">
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <div class="flex items-center">
                                                    <span class="text-2xl mr-3" x-text="getFileIcon(file.type)"></span>
                                                    <div>
                                                        <div class="text-sm font-medium text-gray-900 dark:text-white" x-text="file.filename"></div>
                                                        <div class="text-sm text-gray-500 dark:text-gray-400" x-text="file.description || ''"></div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span :class="getTypeColor(file.type)" class="px-2 py-1 text-xs font-semibold rounded-full" x-text="file.type.toUpperCase()"></span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white" x-text="formatFileSize(file.size)"></td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400" x-text="formatTimeAgo(file.created_at)"></td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm space-x-2">
                                                <button @click="downloadFile(file.filename)" class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300">
                                                    Download
                                                </button>
                                                <button @click="deleteFile(file.filename)" class="text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300">
                                                    Delete
                                                </button>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Commercial Track Section -->
                <div x-show="activeTab === 'commercial'" class="space-y-6">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h2 class="text-xl font-semibold text-gray-900 dark:text-white">Commercial Opportunity Discovery</h2>
                                    <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Corporate giving programs, foundations, and CSR initiatives</p>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                                        <span class="text-sm text-gray-600 dark:text-gray-400">Foundation Directory API</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                                        <span class="text-sm text-gray-600 dark:text-gray-400">CSR Analysis</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="p-6">
                            <!-- Commercial Discovery Controls -->
                            <div class="grid grid-cols-1 xl:grid-cols-3 gap-6 mb-6">
                                <div class="xl:col-span-2">
                                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Discovery Filters</h3>
                                    
                                    <!-- Industry Selection -->
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Target Industries</label>
                                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                                            <template x-for="industry in availableIndustries" :key="industry.value">
                                                <label class="flex items-center">
                                                    <input type="checkbox" :value="industry.value" x-model="commercialFilters.industries" class="rounded border-gray-300 text-blue-600">
                                                    <span class="ml-2 text-sm text-gray-700 dark:text-gray-300" x-text="industry.label"></span>
                                                </label>
                                            </template>
                                        </div>
                                    </div>

                                    <!-- Company Size Selection -->
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Company Sizes</label>
                                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                                            <template x-for="size in availableCompanySizes" :key="size.value">
                                                <label class="flex items-center">
                                                    <input type="checkbox" :value="size.value" x-model="commercialFilters.company_sizes" class="rounded border-gray-300 text-blue-600">
                                                    <span class="ml-2 text-sm text-gray-700 dark:text-gray-300" x-text="size.label"></span>
                                                </label>
                                            </template>
                                        </div>
                                    </div>

                                    <!-- Funding Range -->
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Min Amount ($)</label>
                                            <input type="number" x-model.number="commercialFilters.funding_range.min" min="0" step="1000"
                                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Max Amount ($)</label>
                                            <input type="number" x-model.number="commercialFilters.funding_range.max" min="0" step="1000"
                                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Discovery Actions</h3>
                                    
                                    <button @click="startCommercialDiscovery()" 
                                            :disabled="commercialDiscoveryInProgress"
                                            :class="commercialDiscoveryInProgress ? 'bg-gray-400 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700'"
                                            class="w-full px-4 py-3 text-white font-medium rounded-md transition-colors mb-4">
                                        <span x-show="!commercialDiscoveryInProgress">üè¢ Start Commercial Discovery</span>
                                        <span x-show="commercialDiscoveryInProgress" class="flex items-center justify-center">
                                            <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></div>
                                            Discovering...
                                        </span>
                                    </button>

                                    <div class="space-y-2 text-sm">
                                        <div class="flex items-center justify-between py-1 px-2 bg-gray-50 dark:bg-gray-700 rounded">
                                            <span>Foundation Directory</span>
                                            <span class="text-green-600 dark:text-green-400">‚úì Ready</span>
                                        </div>
                                        <div class="flex items-center justify-between py-1 px-2 bg-gray-50 dark:bg-gray-700 rounded">
                                            <span>CSR Analysis</span>
                                            <span class="text-green-600 dark:text-green-400">‚úì Ready</span>
                                        </div>
                                        <div class="flex items-center justify-between py-1 px-2 bg-gray-50 dark:bg-gray-700 rounded">
                                            <span>Corporate Database</span>
                                            <span class="text-green-600 dark:text-green-400">‚úì Ready</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Commercial Results -->
                            <div x-show="commercialOpportunities.length > 0" class="mt-6">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Commercial Opportunities</h3>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
                                    <template x-for="opportunity in filterCommercialOpportunities()" :key="opportunity.id">
                                        <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:shadow-md transition-shadow">
                                            <div class="flex items-start justify-between mb-3">
                                                <h4 class="font-medium text-gray-900 dark:text-white text-sm" x-text="opportunity.organization_name"></h4>
                                                <span :class="getCompatibilityClass(opportunity.compatibility_score)" 
                                                      class="px-2 py-1 text-xs font-semibold rounded-full" 
                                                      x-text="Math.round(opportunity.compatibility_score * 100) + '%'"></span>
                                            </div>
                                            
                                            <p class="text-sm font-medium text-gray-800 dark:text-gray-200 mb-2" x-text="opportunity.program_name"></p>
                                            <p class="text-xs text-gray-600 dark:text-gray-400 mb-3" x-text="opportunity.description"></p>
                                            
                                            <div class="flex items-center justify-between text-xs">
                                                <span class="font-medium text-green-600 dark:text-green-400" x-text="formatFundingAmount(opportunity.funding_amount)"></span>
                                                <span class="text-gray-500 dark:text-gray-400" x-text="opportunity.application_deadline"></span>
                                            </div>
                                            
                                            <div class="mt-3 flex items-center space-x-2">
                                                <template x-for="(value, factor) in opportunity.match_factors" :key="factor">
                                                    <div x-show="value" class="flex items-center">
                                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-1"></div>
                                                        <span class="text-xs text-gray-600 dark:text-gray-400" x-text="factor.replace('_', ' ')"></span>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- State Discovery Section -->
                <div x-show="activeTab === 'states'" class="space-y-6">
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h2 class="text-xl font-semibold text-gray-900 dark:text-white">State-Level Grant Discovery</h2>
                                    <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">State agency grants and state foundation programs</p>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                                        <span class="text-sm text-gray-600 dark:text-gray-400">Multi-State Integration</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="p-6">
                            <!-- State Selection -->
                            <div class="grid grid-cols-1 xl:grid-cols-3 gap-6 mb-6">
                                <div class="xl:col-span-2">
                                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">State Selection</h3>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <template x-for="state in availableStates" :key="state.code">
                                            <div class="border border-gray-200 dark:border-gray-600 rounded-lg p-3">
                                                <label class="flex items-center cursor-pointer">
                                                    <input type="checkbox" :value="state.code" x-model="selectedStates" class="rounded border-gray-300 text-blue-600">
                                                    <div class="ml-3 flex-1">
                                                        <div class="flex items-center justify-between">
                                                            <span class="font-medium text-gray-900 dark:text-white" x-text="state.name"></span>
                                                            <span class="text-sm text-gray-500 dark:text-gray-400" x-text="state.code"></span>
                                                        </div>
                                                        <p class="text-sm text-gray-600 dark:text-gray-400" x-text="state.agencies + ' agencies integrated'"></p>
                                                    </div>
                                                </label>
                                            </div>
                                        </template>
                                    </div>
                                </div>

                                <div>
                                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Discovery Actions</h3>
                                    
                                    <button @click="startStateDiscovery()" 
                                            :disabled="stateDiscoveryInProgress || selectedStates.length === 0"
                                            :class="(stateDiscoveryInProgress || selectedStates.length === 0) ? 'bg-gray-400 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700'"
                                            class="w-full px-4 py-3 text-white font-medium rounded-md transition-colors mb-4">
                                        <span x-show="!stateDiscoveryInProgress">üèõÔ∏è Start State Discovery</span>
                                        <span x-show="stateDiscoveryInProgress" class="flex items-center justify-center">
                                            <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></div>
                                            Discovering...
                                        </span>
                                    </button>

                                    <div x-show="selectedStates.length > 0" class="space-y-2 text-sm">
                                        <p class="text-gray-600 dark:text-gray-400 mb-2">Selected States:</p>
                                        <template x-for="stateCode in selectedStates" :key="stateCode">
                                            <div class="flex items-center justify-between py-1 px-2 bg-blue-50 dark:bg-blue-900/20 rounded">
                                                <span x-text="availableStates.find(s => s.code === stateCode)?.name"></span>
                                                <span class="text-blue-600 dark:text-blue-400 text-xs" x-text="availableStates.find(s => s.code === stateCode)?.agencies + ' agencies'"></span>
                                            </div>
                                        </template>
                                    </div>

                                    <div x-show="selectedStates.length === 0" class="text-sm text-gray-500 dark:text-gray-400 text-center py-4">
                                        Select one or more states to begin discovery
                                    </div>
                                </div>
                            </div>

                            <!-- State Results -->
                            <div x-show="stateOpportunities.length > 0" class="mt-6">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">State Opportunities</h3>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <template x-for="opportunity in stateOpportunities" :key="opportunity.id">
                                        <div class="bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:shadow-md transition-shadow">
                                            <div class="flex items-start justify-between mb-3">
                                                <div class="flex items-center space-x-2">
                                                    <span class="px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded-full" x-text="opportunity.state"></span>
                                                    <span class="px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded-full" x-text="Math.round(opportunity.priority_score * 100) + '%'"></span>
                                                </div>
                                            </div>
                                            
                                            <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-1" x-text="opportunity.agency_name"></h4>
                                            <p class="text-sm font-medium text-gray-800 dark:text-gray-200 mb-2" x-text="opportunity.program_name"></p>
                                            <p class="text-xs text-gray-600 dark:text-gray-400 mb-3" x-text="opportunity.description"></p>
                                            
                                            <div class="flex items-center justify-between text-xs mb-2">
                                                <span class="font-medium text-green-600 dark:text-green-400" x-text="formatFundingAmount(opportunity.funding_amount)"></span>
                                                <span class="text-gray-500 dark:text-gray-400" x-text="opportunity.application_deadline"></span>
                                            </div>
                                            
                                            <div class="flex flex-wrap gap-1">
                                                <template x-for="area in opportunity.focus_areas" :key="area">
                                                    <span class="px-2 py-1 text-xs bg-gray-100 text-gray-600 dark:bg-gray-600 dark:text-gray-300 rounded" x-text="area.replace('_', ' ')"></span>
                                                </template>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Testing Interface Tab -->
                <div x-show="activeTab === 'testing'" class="space-y-6" x-init="if (activeTab === 'testing') testingInterface.init()">
                    
                    <!-- Testing Header -->
                    <div class="bg-gradient-to-r from-orange-600 to-red-600 rounded-lg p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <span class="text-3xl mr-4">üß™</span>
                                <div>
                                    <h2 class="text-2xl font-bold">Processor Testing Interface</h2>
                                    <p class="text-orange-100 mt-1">Real-time monitoring, testing, and validation</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <button @click="testingInterface.refreshStatus()" 
                                        class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors">
                                    <span class="text-lg mr-2">üîÑ</span>
                                    Refresh Status
                                </button>
                                <div class="flex items-center px-3 py-2 bg-white/20 rounded-lg">
                                    <span class="text-lg mr-2" x-text="testingInterface.getHealthStatusIcon(testingInterface.systemHealth)"></span>
                                    <span x-text="testingInterface.systemHealth.toUpperCase()"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System Status Overview -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="p-2 bg-blue-100 dark:bg-blue-900 rounded-lg">
                                    <span class="text-2xl">üíª</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Total Processors</p>
                                    <p class="text-2xl font-bold text-gray-900 dark:text-white" x-text="testingInterface.processorStatuses.length"></p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="p-2 bg-green-100 dark:bg-green-900 rounded-lg">
                                    <span class="text-2xl">‚úÖ</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Healthy Processors</p>
                                    <p class="text-2xl font-bold text-green-600" x-text="testingInterface.processorStatuses.filter(p => p.health_status === 'healthy').length"></p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                            <div class="flex items-center">
                                <div class="p-2 bg-red-100 dark:bg-red-900 rounded-lg">
                                    <span class="text-2xl">‚ùå</span>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-600 dark:text-gray-400">Error Count</p>
                                    <p class="text-2xl font-bold text-red-600" x-text="testingInterface.processorStatuses.filter(p => p.health_status === 'error').length"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Processor Status Table -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Processor Status Monitoring</h3>
                                <div class="flex items-center space-x-3">
                                    <button @click="testingInterface.toggleLogViewer()" 
                                            class="bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 px-3 py-2 rounded-md transition-colors">
                                        <span class="text-sm">üìã View Logs</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Processor</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Type</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Health Details</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <template x-for="processor in testingInterface.processorStatuses" :key="processor.name">
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <div class="flex items-center">
                                                    <span class="text-lg mr-2" x-text="testingInterface.getHealthStatusIcon(processor.health_status)"></span>
                                                    <span class="text-sm font-medium" 
                                                          :class="testingInterface.getHealthStatusColor(processor.health_status)"
                                                          x-text="processor.health_status"></span>
                                                </div>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <div class="text-sm font-medium text-gray-900 dark:text-white" x-text="processor.name"></div>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200" x-text="processor.type"></span>
                                            </td>
                                            <td class="px-6 py-4">
                                                <div class="text-sm text-gray-500 dark:text-gray-400" x-text="processor.health_details"></div>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                <div class="flex space-x-2">
                                                    <button @click="testingInterface.showTestDialog(processor.name)" 
                                                            :disabled="testingInterface.testRunning"
                                                            class="bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-3 py-1 rounded text-xs">
                                                        Configure & Test
                                                    </button>
                                                    <button @click="testingInterface.testProcessor(processor.name)" 
                                                            :disabled="testingInterface.testRunning"
                                                            class="bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white px-3 py-1 rounded text-xs">
                                                        Quick Test
                                                    </button>
                                                    <button @click="testingInterface.loadProcessorLogs(processor.name)" 
                                                            class="bg-gray-600 hover:bg-gray-700 text-white px-3 py-1 rounded text-xs">
                                                        Logs
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Log Viewer Modal -->
                    <div x-show="testingInterface.logViewerVisible" 
                         x-transition:enter="transition ease-out duration-300"
                         x-transition:enter-start="opacity-0"
                         x-transition:enter-end="opacity-100"
                         x-transition:leave="transition ease-in duration-200"
                         x-transition:leave-start="opacity-100"
                         x-transition:leave-end="opacity-0"
                         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                        <div class="bg-white dark:bg-gray-800 rounded-lg w-full max-w-4xl h-3/4 overflow-hidden">
                            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">System Logs</h3>
                                <button @click="testingInterface.toggleLogViewer()" 
                                        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                                    <span class="text-xl">√ó</span>
                                </button>
                            </div>
                            <div class="p-6 h-full overflow-y-auto">
                                <div class="space-y-2">
                                    <template x-for="log in testingInterface.systemLogs" :key="log.timestamp">
                                        <div class="flex space-x-4 py-2 border-b border-gray-100 dark:border-gray-700">
                                            <div class="text-xs text-gray-500 dark:text-gray-400 w-24 flex-shrink-0" x-text="new Date(log.timestamp).toLocaleTimeString()"></div>
                                            <div class="text-xs font-semibold w-16 flex-shrink-0" 
                                                 :class="{'text-red-600': log.level === 'ERROR', 'text-yellow-600': log.level === 'WARNING', 'text-blue-600': log.level === 'INFO', 'text-gray-600': log.level === 'DEBUG'}"
                                                 x-text="log.level"></div>
                                            <div class="text-sm text-gray-900 dark:text-white flex-1" x-text="log.message"></div>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Test Configuration Dialog -->
                    <div x-show="testingInterface.configDialogVisible" 
                         x-transition:enter="transition ease-out duration-300"
                         x-transition:enter-start="opacity-0"
                         x-transition:enter-end="opacity-100"
                         x-transition:leave="transition ease-in duration-200"
                         x-transition:leave-start="opacity-100"
                         x-transition:leave-end="opacity-0"
                         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                        <div class="bg-white dark:bg-gray-800 rounded-lg w-full max-w-2xl max-h-3/4 overflow-hidden">
                            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
                                    Configure Test Parameters: <span x-text="testingInterface.selectedProcessor"></span>
                                </h3>
                                <button @click="testingInterface.closeConfigDialog()" 
                                        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                                    <span class="text-xl">√ó</span>
                                </button>
                            </div>
                            <div class="p-6 overflow-y-auto">
                                <form @submit.prevent="testingInterface.runConfiguredTest()">
                                    <div class="space-y-6">
                                        
                                        <!-- Common Parameters -->
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                    Max Results
                                                </label>
                                                <input type="number" 
                                                       x-model="testingInterface.configParams.max_results"
                                                       min="1" max="100"
                                                       class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                    State
                                                </label>
                                                <select x-model="testingInterface.configParams.state"
                                                        class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                                    <option value="VA">Virginia</option>
                                                    <option value="MD">Maryland</option>
                                                    <option value="DC">Washington DC</option>
                                                    <option value="PA">Pennsylvania</option>
                                                    <option value="NC">North Carolina</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Processor-specific parameters -->
                                        <div x-show="['bmf_filter', 'propublica_fetch'].includes(testingInterface.selectedProcessor)">
                                            <h4 class="text-md font-semibold text-gray-900 dark:text-white mb-3">Organization Discovery Parameters</h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                        Minimum Revenue
                                                    </label>
                                                    <input type="number" 
                                                           x-model="testingInterface.configParams.min_revenue"
                                                           min="0" step="1000"
                                                           class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                        NTEE Codes
                                                    </label>
                                                    <input type="text" 
                                                           x-model="testingInterface.configParams.ntee_codes"
                                                           placeholder="E.g., E21,E30,F30"
                                                           class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                                </div>
                                            </div>
                                        </div>

                                        <div x-show="['grants_gov_fetch', 'usaspending_fetch'].includes(testingInterface.selectedProcessor)">
                                            <h4 class="text-md font-semibold text-gray-900 dark:text-white mb-3">Government Grant Parameters</h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                        Keywords
                                                    </label>
                                                    <input type="text" 
                                                           x-model="testingInterface.configParams.keywords"
                                                           placeholder="E.g., education,health,community"
                                                           class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                        Opportunity Category
                                                    </label>
                                                    <select x-model="testingInterface.configParams.opportunity_category"
                                                            class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                                        <option value="">All Categories</option>
                                                        <option value="D">Discretionary</option>
                                                        <option value="M">Mandatory</option>
                                                        <option value="O">Other</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <div x-show="['foundation_directory_fetch', 'corporate_csr_analyzer'].includes(testingInterface.selectedProcessor)">
                                            <h4 class="text-md font-semibold text-gray-900 dark:text-white mb-3">Commercial Discovery Parameters</h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                        Industries
                                                    </label>
                                                    <input type="text" 
                                                           x-model="testingInterface.configParams.industries"
                                                           placeholder="E.g., technology,healthcare"
                                                           class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                        Funding Range Min
                                                    </label>
                                                    <input type="number" 
                                                           x-model="testingInterface.configParams.funding_range_min"
                                                           min="0" step="1000"
                                                           class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                                </div>
                                            </div>
                                        </div>

                                        <div x-show="['intelligent_classifier'].includes(testingInterface.selectedProcessor)">
                                            <h4 class="text-md font-semibold text-gray-900 dark:text-white mb-3">Classification Parameters</h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                        Minimum Score
                                                    </label>
                                                    <input type="number" 
                                                           x-model="testingInterface.configParams.min_score"
                                                           min="0" max="1" step="0.1"
                                                           class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                                </div>
                                                <div class="flex items-center">
                                                    <input type="checkbox" 
                                                           x-model="testingInterface.configParams.detailed_analysis"
                                                           class="rounded border-gray-300 dark:border-gray-600 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                                    <label class="ml-2 text-sm font-medium text-gray-700 dark:text-gray-300">
                                                        Detailed Analysis
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Test Data Input -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                Test Data (JSON format, optional)
                                            </label>
                                            <textarea x-model="testingInterface.configParams.test_data"
                                                      rows="4"
                                                      placeholder='[{"ein": "123456789", "name": "Test Organization"}]'
                                                      class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm"></textarea>
                                        </div>

                                    </div>

                                    <div class="flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
                                        <button type="button" 
                                                @click="testingInterface.closeConfigDialog()"
                                                class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors">
                                            Cancel
                                        </button>
                                        <button type="submit" 
                                                :disabled="testingInterface.testRunning"
                                                class="px-6 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 rounded-md transition-colors">
                                            <span x-show="!testingInterface.testRunning">Run Test</span>
                                            <span x-show="testingInterface.testRunning">Testing...</span>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Test Results Panel -->
                    <div x-show="Object.keys(testingInterface.testResults).length > 0" class="bg-white dark:bg-gray-800 rounded-lg shadow-lg">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Test Results</h3>
                                <div class="flex items-center space-x-3">
                                    <select x-model="testingInterface.exportFormat" 
                                            class="border border-gray-300 dark:border-gray-600 rounded-md px-3 py-1 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                        <option value="json">JSON</option>
                                        <option value="csv">CSV</option>
                                    </select>
                                    <input type="text" 
                                           x-model="testingInterface.exportFilename"
                                           placeholder="Export filename"
                                           class="border border-gray-300 dark:border-gray-600 rounded-md px-3 py-1 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                </div>
                            </div>
                        </div>
                        
                        <div class="p-6">
                            <template x-for="(result, processorName) in testingInterface.testResults" :key="processorName">
                                <div class="mb-6 p-4 border border-gray-200 dark:border-gray-700 rounded-lg">
                                    <div class="flex items-center justify-between mb-3">
                                        <h4 class="font-semibold text-gray-900 dark:text-white" x-text="processorName"></h4>
                                        <div class="flex items-center space-x-2">
                                            <span class="text-xs text-gray-500 dark:text-gray-400" x-text="'Execution time: ' + result.execution_time_seconds + 's'"></span>
                                            <button @click="testingInterface.exportTestResults(processorName)" 
                                                    class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs">
                                                Export
                                            </button>
                                        </div>
                                    </div>
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-md p-3 text-sm">
                                        <pre class="text-gray-800 dark:text-gray-200 whitespace-pre-wrap" x-text="JSON.stringify(result, null, 2)"></pre>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>

                </div>

                <!-- Settings Tab -->
                <div x-show="activeTab === 'settings'" class="space-y-6">
                    
                    <!-- API Configuration -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center">
                            <span class="text-2xl mr-3">üîë</span>
                            API Configuration
                        </h3>
                        
                        <form @submit.prevent="saveApiSettings()" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ProPublica API Key</label>
                                    <input type="password" x-model="settings.propublicaApiKey" placeholder="Enter API key..." 
                                           class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">API Timeout (ms)</label>
                                    <input type="number" x-model="settings.apiTimeout" min="1000" max="60000" 
                                           class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                </div>
                            </div>
                            
                            <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                                Save API Settings
                            </button>
                        </form>
                    </div>
                    
                    <!-- Processing Settings -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center">
                            <span class="text-2xl mr-3">‚ö°</span>
                            Processing Settings
                        </h3>
                        
                        <form @submit.prevent="saveProcessingSettings()" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Concurrent Requests</label>
                                    <input type="number" x-model="settings.concurrentRequests" min="1" max="20" 
                                           class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Retry Attempts</label>
                                    <input type="number" x-model="settings.retryAttempts" min="1" max="5" 
                                           class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Cache Expiry (hours)</label>
                                    <input type="number" x-model="settings.cacheExpiry" min="1" max="168" 
                                           class="w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm dark:bg-gray-700 dark:text-white">
                                </div>
                            </div>
                            
                            <div class="flex items-center space-x-4">
                                <label class="flex items-center">
                                    <input type="checkbox" x-model="settings.enableCaching" class="rounded mr-2">
                                    <span class="text-sm text-gray-700 dark:text-gray-300">Enable caching</span>
                                </label>
                                
                                <label class="flex items-center">
                                    <input type="checkbox" x-model="settings.autoExport" class="rounded mr-2">
                                    <span class="text-sm text-gray-700 dark:text-gray-300">Auto-export results</span>
                                </label>
                            </div>
                            
                            <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                                Save Processing Settings
                            </button>
                        </form>
                    </div>
                    
                    <!-- System Information -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg dark:shadow-gray-900/50 p-6 animate-fade-in">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center">
                            <span class="text-2xl mr-3">üíª</span>
                            System Information
                        </h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-3">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Version:</span>
                                    <span class="font-medium">Catalynx 2.0</span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Processors Available:</span>
                                    <span class="font-medium" x-text="systemInfo.processorsCount || 12"></span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Cache Size:</span>
                                    <span class="font-medium" x-text="formatFileSize(systemInfo.cacheSize || 0)"></span>
                                </div>
                            </div>
                            
                            <div class="space-y-3">
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Uptime:</span>
                                    <span class="font-medium" x-text="systemInfo.uptime || 'Unknown'"></span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">Total Organizations:</span>
                                    <span class="font-medium" x-text="(systemInfo.totalOrganizations || 0).toLocaleString()"></span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-gray-600 dark:text-gray-400">BMF Records:</span>
                                    <span class="font-medium" x-text="(systemInfo.bmfRecords || 0).toLocaleString()"></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
                            <div class="flex space-x-4">
                                <button @click="clearCache()" class="px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700">
                                    Clear Cache
                                </button>
                                <button @click="exportSystemLogs()" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700">
                                    Export Logs
                                </button>
                                <button @click="resetSettings()" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">
                                    Reset to Defaults
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
            </main>
        </div>
    </div>

    <!-- Advanced Filter Modal -->
    <div x-show="filterModalOpen" x-cloak class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50" @click.self="filterModalOpen = false">
        <div class="relative top-20 mx-auto p-6 border w-11/12 max-w-2xl shadow-lg rounded-md bg-white dark:bg-gray-800">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Advanced Filters</h3>
                <button @click="filterModalOpen = false" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Score Range -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Score Range</label>
                    <div class="flex space-x-2">
                        <input type="number" x-model="advancedFilters.score.min" step="0.1" min="0" max="1" 
                               placeholder="Min" class="flex-1 px-3 py-2 border border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        <input type="number" x-model="advancedFilters.score.max" step="0.1" min="0" max="1" 
                               placeholder="Max" class="flex-1 px-3 py-2 border border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    </div>
                </div>

                <!-- State -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">State</label>
                    <select x-model="advancedFilters.state" class="w-full px-3 py-2 border border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        <option value="">All States</option>
                        <option value="VA">Virginia</option>
                        <option value="MD">Maryland</option>
                        <option value="DC">Washington DC</option>
                        <option value="NY">New York</option>
                        <option value="CA">California</option>
                    </select>
                </div>

                <!-- Organization Type -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Organization Type</label>
                    <select x-model="advancedFilters.organizationType" class="w-full px-3 py-2 border border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        <option value="">All Types</option>
                        <option value="nonprofit">Nonprofit</option>
                        <option value="foundation">Foundation</option>
                        <option value="government">Government</option>
                        <option value="corporate">Corporate</option>
                    </select>
                </div>

                <!-- Status -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
                    <select x-model="advancedFilters.status" class="w-full px-3 py-2 border border-gray-300 rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                        <option value="">All Status</option>
                        <option value="active">Active</option>
                        <option value="pending">Pending</option>
                        <option value="completed">Completed</option>
                        <option value="archived">Archived</option>
                    </select>
                </div>
            </div>

            <!-- Saved Filters -->
            <div class="mt-6" x-show="savedFilters.length > 0">
                <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Saved Filters</h4>
                <div class="flex flex-wrap gap-2">
                    <template x-for="filter in savedFilters" :key="filter.name">
                        <button @click="loadSavedFilter(filter)" 
                                class="px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full text-sm hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors"
                                x-text="filter.name">
                        </button>
                    </template>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-between mt-8">
                <div class="space-x-3">
                    <button @click="saveCurrentFilter()" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors">
                        Save Filter
                    </button>
                    <button @click="advancedFilters = { stage: '', status: '', score: { min: 0, max: 1 }, dateRange: { start: '', end: '' }, organizationType: '', state: '', tags: [] }" 
                            class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors">
                        Reset
                    </button>
                </div>
                <div class="space-x-3">
                    <button @click="filterModalOpen = false" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors">
                        Cancel
                    </button>
                    <button @click="applyAdvancedFilters()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                        Apply Filters
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Collaboration Modal -->
    <div x-show="collaborationModalOpen" x-cloak class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50" @click.self="collaborationModalOpen = false">
        <div class="relative top-20 mx-auto p-6 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white dark:bg-gray-800">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Team Collaboration</h3>
                <button @click="collaborationModalOpen = false" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Team Members -->
                <div>
                    <h4 class="text-md font-medium text-gray-900 dark:text-white mb-4">Team Members</h4>
                    <div class="space-y-3">
                        <template x-for="member in teamMembers" :key="member.id">
                            <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-medium" x-text="member.avatar"></div>
                                    <div>
                                        <p class="font-medium text-gray-900 dark:text-white" x-text="member.name"></p>
                                        <p class="text-sm text-gray-500 dark:text-gray-400" x-text="member.role"></p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div :class="member.status === 'online' ? 'bg-green-400' : 'bg-gray-400'" class="w-3 h-3 rounded-full"></div>
                                    <span class="text-sm text-gray-500 dark:text-gray-400" x-text="member.status"></span>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Recent Activity & Notifications -->
                <div>
                    <h4 class="text-md font-medium text-gray-900 dark:text-white mb-4">Recent Activity</h4>
                    <div class="space-y-3 max-h-64 overflow-y-auto">
                        <template x-for="notification in notifications.slice().reverse()" :key="notification.id">
                            <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg" :class="{ 'border-l-4 border-blue-500': !notification.read }">
                                <div class="flex justify-between">
                                    <p class="text-sm text-gray-900 dark:text-white" x-text="notification.message"></p>
                                    <button @click="markNotificationRead(notification.id)" x-show="!notification.read" 
                                            class="text-xs text-blue-600 hover:text-blue-800">Mark Read</button>
                                </div>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1" x-text="new Date(notification.timestamp).toLocaleString()"></p>
                            </div>
                        </template>
                        <div x-show="notifications.length === 0" class="p-3 text-center text-gray-500 dark:text-gray-400">
                            No recent activity
                        </div>
                    </div>
                </div>
            </div>

            <!-- Workflow Sharing -->
            <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-600">
                <h4 class="text-md font-medium text-gray-900 dark:text-white mb-4">Quick Actions</h4>
                <div class="flex space-x-3">
                    <button @click="shareWorkflow('current', teamMembers.map(m => m.id))" 
                            class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                        Share Current Workflow
                    </button>
                    <button @click="addWorkflowComment('current', prompt('Add comment:'))" 
                            class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">
                        Add Comment
                    </button>
                    <button @click="assignWorkflow('current', teamMembers[1].id)" 
                            class="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors">
                        Assign to Analyst
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script src="/static/app.js"></script>
    
</body>
</html>