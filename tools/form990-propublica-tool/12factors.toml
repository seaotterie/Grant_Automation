[tool]
name = "form990-propublica"
version = "1.0.0"
description = "ProPublica API enrichment for comprehensive nonprofit intelligence - 12-Factor Agents implementation"
intent = "propublica_enrichment"
framework = "12-factor-agents"
integration_type = "catalynx_tool"

[tool.capabilities]
primary = "api_enrichment"
secondary = ["peer_analysis", "leadership_intelligence", "filing_history", "program_details"]
data_sources = ["propublica_api", "nonprofit_explorer"]

[tool.input]
type = "ProPublicaEnrichmentCriteria"
schema = "baml_src/propublica_enrichment.baml"
validation = "strict"
natural_language = false

[tool.output]
type = "ProPublicaEnrichmentResult"
schema = "baml_src/propublica_enrichment.baml"
format = "structured"
metadata_included = true

[tool.dependencies]
database = "none"
cache = "required"
llm = "none"
external_apis = ["propublica_nonprofit_explorer"]

[tool.integration]
catalynx_database = "data/nonprofit_intelligence.db"
existing_processors = ["propublica_fetch"]
comparison_benchmarks = true
migration_pathway = "gradual_replacement"

[tool.performance]
max_concurrent = 3
timeout_seconds = 30
cache_ttl = 86400
max_results = 25
target_response_time_ms = 1000
memory_limit_mb = 512

[tool.12factors]
# Human Layer 12-Factor Agents Framework Implementation
# https://github.com/humanlayer/12-factor-agents

natural_language_to_tools = false      # Factor 1: Takes structured EINs from Form 990 tool
own_prompts = true                     # Factor 2: Full control over API data processing and enrichment
own_context_window = true              # Factor 3: Minimal context - API handles data retrieval
tools_as_structured_outputs = true     # Factor 4: Forces structured ProPublicaEnrichmentResult output
unify_execution_business_state = true  # Factor 5: API enrichment unified with grant research workflows
launch_pause_resume_apis = true        # Factor 6: Simple async execute() method with rate limiting
contact_humans_tool_calls = true       # Factor 7: Provides human-readable peer analysis and insights
control_flow_management = true         # Factor 8: Explicit control over API calls and data enrichment
compact_error_handling = true          # Factor 9: API errors integrated into result structure
small_focused_agents = true            # Factor 10: Single responsibility - ProPublica API enrichment only
trigger_from_anywhere = true           # Factor 11: Can be triggered from workflows or standalone
stateless_reducer_model = true         # Factor 12: Pure function - EINs → enriched profiles

[tool.factor_implementations]
# Detailed implementation of key 12-factor agents principles

factor_1_implementation = "Takes structured EIN list from Form 990 analysis tool, not natural language"
factor_2_implementation = "Complete control over ProPublica API integration and data processing"
factor_3_implementation = "Minimal context - ProPublica API provides data, not LLM context"
factor_4_implementation = "Tool forces structured ProPublicaEnrichmentResult with guaranteed JSON format"
factor_5_implementation = "API enrichment state integrated with nonprofit grant research workflows"
factor_6_implementation = "Single async execute() method with intelligent rate limiting and caching"
factor_7_implementation = "Results include human-readable peer analysis and organizational insights"
factor_8_implementation = "Explicit flow: EINs → API calls → peer analysis → structured enrichment"
factor_9_implementation = "API errors and rate limits integrated into ProPublicaEnrichmentResult"
factor_10_implementation = "Single responsibility: comprehensive ProPublica API enrichment only"
factor_11_implementation = "Triggered from Form 990 results, web UI, API, or workflow orchestrator"
factor_12_implementation = "Pure function: ProPublicaEnrichmentCriteria → ProPublicaEnrichmentResult"

[tool.factor_4_details]
# Factor 4: Tools as Structured Outputs - API Enrichment Implementation
structured_output_enforcement = "Guarantees ProPublicaEnrichmentResult with peer analysis, filing history"
output_schema = "ProPublicaOrganizationProfile[] with leadership, programs, peer organizations"
reliability_improvement = "Eliminates API response parsing errors in production environments"
deterministic_outputs = "Consistent peer analysis and organizational profile structure"
tool_as_formatter = "Tool serves as API data formatter with guaranteed enrichment structure"
production_readiness = "Reliable API enrichment for production grant research workflows"

[tool.environment]
# Environment variable configuration
required_vars = [
    "PROPUBLICA_API_BASE_URL"
]
optional_vars = [
    "PROPUBLICA_CACHE_ENABLED",
    "PROPUBLICA_RATE_LIMIT_CALLS",
    "PROPUBLICA_RATE_LIMIT_DELAY",
    "PROPUBLICA_MAX_ORGANIZATIONS",
    "PROPUBLICA_TIMEOUT_SECONDS",
    "PROPUBLICA_LOG_PERFORMANCE"
]
config_file = ".env.tool"

[tool.deployment]
# Deployment and scaling configuration
container_ready = true
health_check_endpoint = "/health"
metrics_endpoint = "/metrics"
graceful_shutdown_timeout = 10
min_instances = 1
max_instances = 2
auto_scaling = true

[tool.testing]
# Testing strategy and requirements
unit_tests = "tests/test_propublica_tool.py"
integration_tests = "tests/test_api_integration.py"
performance_tests = "tests/test_enrichment_performance.py"
coverage_target = 85
benchmark_existing = true

[tool.documentation]
# Documentation and examples
readme = "README.md"
api_spec = "auto_generated"
examples = "app/propublica_enricher.py"
architecture_comparison = true
migration_guide = true